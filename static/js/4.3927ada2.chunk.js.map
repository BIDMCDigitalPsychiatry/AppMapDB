{"version":3,"sources":["components/application/GenericTable/TablePlaceHolder.tsx","components/application/GenericTable/VirtualTable.tsx","components/application/GenericTable/ExploreGridItem.tsx","react-virtuoso/src/comparators.tsx","react-virtuoso/src/domIOSystem.ts","react-virtuoso/src/loggerSystem.ts","react-virtuoso/src/propsReadySystem.ts","react-virtuoso/src/stateFlagsSystem.ts","react-virtuoso/src/scrollSeekSystem.ts","react-virtuoso/src/AATree.ts","react-virtuoso/src/utils/binaryArraySearch.ts","react-virtuoso/src/utils/correctItemSize.ts","react-virtuoso/src/sizeSystem.ts","react-virtuoso/src/scrollToIndexSystem.ts","react-virtuoso/src/sizeRangeSystem.ts","react-virtuoso/src/windowScrollerSystem.ts","react-virtuoso/src/gridSystem.ts","react-virtuoso/src/hooks/useSize.ts","react-virtuoso/src/hooks/useWindowViewportRect.ts","react-virtuoso/src/hooks/useIsomorphicLayoutEffect.ts","react-virtuoso/src/hooks/useChangedChildSizes.ts","react-virtuoso/src/hooks/useScrollTop.ts","react-virtuoso/src/initialTopMostItemIndexSystem.ts","react-virtuoso/src/followOutputSystem.ts","react-virtuoso/src/groupedListSystem.ts","react-virtuoso/src/listStateSystem.ts","react-virtuoso/src/initialItemCountSystem.ts","react-virtuoso/src/topItemCountSystem.ts","react-virtuoso/src/totalListHeightSystem.ts","react-virtuoso/src/upwardScrollFixSystem.ts","react-virtuoso/src/initialScrollTopSystem.ts","react-virtuoso/src/alignToBottomSystem.ts","react-virtuoso/src/scrollIntoViewSystem.ts","react-virtuoso/src/listSystem.ts","react-virtuoso/src/utils/positionStickyCssValue.ts","react-virtuoso/src/utils/simpleMemoize.ts","react-virtuoso/src/List.tsx","react-virtuoso/src/Grid.tsx","react-virtuoso/src/Table.tsx","react-virtuoso/src/components.tsx","components/application/GenericTable/ExploreGrid.tsx","components/application/GenericTable/VirtualList.tsx","components/application/GenericTable/GenericTable.tsx"],"names":["connect","state","ownProp","name","placeholder","table","primary","secondary","tab","props","renderPlaceholder","Typography","color","variant","style","padding","align","gridStyle","border","sharedTableStyle","tableStyle","display","tableScrollStyle","palette","width","height","backgroundColor","light","borderRadius","useStyles","makeStyles","spacing","layout","createStyles","tableRounded","borderBottomLeftRadius","borderBottomRightRadius","tableScroll","tableScrollRounded","cellHovered","cellSelected","common","white","main","checkbox","paddingLeft","paddingRight","checkboxIcon","selectedHeader","multiselectbarheight","marginBottom","contentrowspacing","cell","collapse","background","grey","getRowData","selectedRowIds","data","map","rid","find","d","id","filter","row","VirtualTable","classes","useTheme","includeHeaders","fixedRowCount","fixedColumnCount","rowHeight","tableRowHeight","rounded","hover","onCellClick","undefined","onHeaderClick","isCellHovered","select","columns","MultiSelectToolbar","showScroll","rowDivider","TableStore","tableUpdate","sortinjectedcolumns","evalFunc","c","sort","event","column","orderBy","orderDirection","sortComparator","initialState","setState","length","itemtxt","adjustedheight","Collapse","className","in","Grid","container","direction","justify","alignItems","item","xs","zeroMinWidth","noWrap","alignContent","rowData","cellProps","size","borderBottom","classNames","header","Checkbox","checkedIcon","indeterminateIcon","checked","onChange","e","prevState","indeterminate","some","isCellSelected","hoveredColumn","hoveredRowData","theme","root","flex","textAlign","transition","transform","cursor","cardContent","paddingTop","paddingBottom","media","wrapper","overflow","text","fontFamily","typography","fontSize","h2","fontWeight","fontWeightBold","lineHeight","h3","body1","marginTop","ExploreGridItem","getAppName","company","getAppCompany","platforms","costs","androidLink","iosLink","androidStore","appleStore","webLink","icon","getAppIcon","created","updated","children","React","raised","handleChangeRoute","useHandleChangeRoute","content","isEmpty","description","Card","CardContent","onClick","publicUrl","app","from","onMouseOver","onMouseOut","elevation","CardMedia","image","component","alt","PlatformButtons","DialogButton","Icon","tooltip","join","dangerouslySetInnerHTML","__html","lineClamp","stripContent","getDayTimeFromTimestamp","tupleComparator","prev","current","rangeComparator","next","startIndex","endIndex","LogLevel","domIOSystem","u","scrollContainerState","scrollTop","deviation","smoothScrollTargetReached","statefulScrollTop","viewportHeight","scrollHeight","headerHeight","footerHeight","scrollTo","scrollBy","scrollingInProgress","singleton","CONSOLE_METHOD_MAP","DEBUG","INFO","WARN","ERROR","getGlobalThis","globalThis","window","loggerSystem","logLevel","log","label","message","level","currentLevel","console","propsReadySystem","propsReady","didMount","ready","value","getValue","tup","UP","DOWN","INITIAL_BOTTOM_STATE","atBottom","notAtBottomBecause","offsetBottom","stateFlagsSystem","isAtBottom","isAtTop","atBottomStateChange","atTopStateChange","atBottomThreshold","isScrolling","isScrollingBy","top","atBottomState","atBottomBecause","scrollTopDelta","lastJumpDueToItemResize","jump","changed","setTimeout","scrollDirection","acc","prevScrollTop","scrollVelocity","scrollSeekSystem","isSeeking","rangeChanged","scrollSeekConfiguration","speed","config","range","exit","enter","velocity","change","scrollSeekRangeChanged","NIL_NODE","lvl","newAANode","k","v","l","r","empty","node","newTree","remove","key","last","adjust","clone","deleteLast","findMaxKeyValue","field","Infinity","insert","rebalance","walkWithin","start","end","result","concat","push","walk","args","isSingle","split","skew","Error","rl","rlvl","rangesWithin","toRanges","arrayToRanges","items","parser","index","i","nextIndex","nextValue","nodes","findIndexOfClosestSmallerOrEqual","comparator","Math","floor","match","findClosestSmallerOrEqual","findRange","startValue","endValue","slice","correctItemSize","el","dimension","round","getBoundingClientRect","rangeIncludes","refRange","indexComparator","itemIndex","offsetComparator","offset","itemOffset","offsetPointParser","point","sizeStateReducer","ranges","groupIndices","sizeTree","offsetTree","newSizeTree","syncStart","groupSize","itemSize","reduce","tree","groupIndex","min","overlappingRanges","firstPassDone","shouldInsert","rangeStart","rangeEnd","rangeValue","insertRanges","prevIndex","prevSize","prevAOffset","startAIndex","arrayBinarySearch","kv","aOffset","groupOffsetTree","offsetOf","lastIndex","lastOffset","lastSize","originalIndexFromItemIndex","sizes","hasGroups","groupOffset","SIZE_MAP","offsetHeight","offsetWidth","sizeSystem","sizeRanges","totalCount","unshiftWith","firstItemIndex","fixedItemSize","defaultItemSize","initial","indexes","idx","trackItemSizes","listRefresh","oldSizes","newSizes","diff","val","beforeUnshiftWith","SUPPORTS_SCROLL_TO_OPTIONS","document","documentElement","normalizeIndexLocation","location","behavior","scrollToIndexSystem","scrollToIndex","topListHeight","unsubscribeNextListRefresh","cleartTimeoutRef","unsubscribeListRefresh","cleanup","clearTimeout","normalLocation","max","limit","retry","listChanged","done","timeoutRef","TOP","BOTTOM","getOverscan","overscan","reverse","getViewportIncrease","sizeRangeSystem","listBoundary","fixedHeaderHeight","increaseViewportBy","visibleRange","headerVisible","topViewportAddition","bottomViewportAddition","windowScrollerSystem","windowScrollContainerState","windowViewportRect","windowScrollTo","useWindowScroll","scrollElement","windowScrollTop","offsetTop","INITIAL_GRID_STATE","bottom","itemHeight","itemWidth","PROBE_GRID_STATE","ceil","hackFloor","buildItems","Array","_","gridSystem","stateFlags","scrollSeek","initialItemCount","gridState","viewportDimensions","itemDimensions","startOffset","endOffset","viewport","viewportWidth","perRow","gridLayout","endReached","startReached","itemTop","totalListHeight","viewportInfo","visibleWidth","visibleHeight","useSizeWithElRef","callback","enabled","ref","useRef","callbackRef","_el","ResizeObserver","observer","entries","element","target","offsetParent","elRef","observe","unobserve","useSize","useWindowViewportRectRef","calculateInfo","useCallback","rect","innerHeight","pageYOffset","seRect","deltaTop","getScrollElementInfo","windowEH","useResizeObserver","useEffect","addEventListener","removeEventListener","useIsomorphicLayoutEffect","useLayoutEffect","useChangedListContentsSizes","scrollContainerStateCallback","results","child","dataset","parseInt","knownSize","parseFloat","lastResult","getChangedChildSizes","scrollableElement","parentElement","firstElementChild","approximatelyEqual","num1","num2","abs","useScrollTop","scrollerElement","scrollerRefCallback","scrollerRef","scrollTopTarget","handler","ev","scrollToCallback","isSmooth","maxScrollTop","scrollByCallback","localRef","passive","initialTopMostItemIndexSystem","scrolledToInitialItem","initialTopMostItemIndex","normalizeFollowOutput","follow","followOutputSystem","followOutput","pendingScrollHandle","scrollToBottom","followOutputBehavior","shouldFollow","behaviorFromFollowOutput","refreshed","cancel","groupCountsToIndicesAndCount","counts","groupCount","groupedListSystem","system","groupCounts","stream","topItemsIndexes","groupIndicesAndCount","streamFromEmitter","pipe","prop","combineLatest","distinctUntilChanged","EMPTY_LIST_STATE","topItems","transposeItems","originalIndex","transposedItems","groupRanges","currentRange","currentGroupIndex","shift","indexOf","transposedItem","type","buildListState","lastItem","listStateSystem","rangeTopListHeight","itemsRendered","listState","sizesValue","probeItemSet","rangeStartIndex","rangeEndIndex","minStartIndex","offsetPointRanges","rangesWithinOffsets","maxIndex","initialItemCountSystem","count","includedGroupsCount","adjustedCount","topItemCountSystem","topItemCount","statefulStream","totalListHeightSystem","totalListHeightChanged","upwardScrollFixSystem","deviationOffset","prevItems","prevTotalCount","newDev","prevFirstItemIndex","atStart","onlyItem","prevItem","pItem","amount","is","initialScrollTopSystem","initialScrollTop","alignToBottomSystem","alignToBottom","paddingTopAddition","scrollIntoViewSystem","scrollIntoView","featureGroup1System","sizeRange","windowScroller","listSystem","domIO","flags","featureGroup1","fixedItemHeight","defaultItemHeight","WEBKIT_STICKY","STICKY","positionStickyCssValue","func","called","simpleMemoize","createElement","position","identity","listComponentPropsSystem","itemContent","groupContent","components","computeItemKey","headerFooterTag","noop","distinctProp","propName","defaultValue","statefulStreamFromEmitter","FooterComponent","HeaderComponent","TopItemListComponent","ListComponent","ItemComponent","GroupComponent","ScrollerComponent","EmptyPlaceholder","ScrollSeekPlaceholder","addDeprecatedAlias","alias","subscribe","warn","combinedSystem","propsSystem","deprecatedProps","group","scrollingStateChange","adjustForPrependedItems","maxHeightCacheSize","footer","HeaderContainer","FooterContainer","ItemContainer","ScrollContainer","GroupContainer","ListContainer","emptyComponent","deprecateComponentProp","componentName","withLatestFrom","comp","publish","DefaultScrollSeekPlaceholder","GROUP_STYLE","zIndex","overflowAnchor","Items","showTopList","useEmitterValue","usePublisher","windowScrollContainerStateCallback","_scrollContainerStateCallback","containerStyle","boxSizing","scrollerStyle","outline","overflowY","WebkitOverflowScrolling","viewportStyle","topItemListStyle","Header","Footer","buildScroller","useEmitter","tabIndex","buildWindowScroller","Viewport","viewportRef","compose","WindowViewport","TopItemListContainer","TopItemList","ListRoot","TheScroller","WindowScroller","Scroller","TheViewport","systemToComponent","required","optional","methods","events","Component","gridComponentPropsSystem","itemClassName","listClassName","GridItems","scrollHeightCallback","listRef","firstItem","firstChild","GridRoot","tableComponentPropsSystem","fixedHeaderContent","TableComponent","TableHeadComponent","TableBodyComponent","TableRowComponent","FillerRow","paddingTopEl","paddingBottomEl","TableRoot","theadRef","TheTable","TheTHead","theHead","borderSpacing","VirtuosoGrid","styled","div","ExploreGrid","GridItem","Item","List","values","getValues","VirtualList","DynamicList","getClassName","handleRefresh","setCache","CellMeasurerCache","fixedWidth","minHeight","cache","deferredMeasurementCache","overscanRowCount","rowCount","rowRenderer","parent","columnIndex","rowIndex","measure","registerChild","tablefooterheight","hint","paper","GenericTable","selector","Data","Height","isList","isGrid","other","useSelector","VirtualComponent","Paper","TablePlaceHolder","Divider"],"mappings":"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","file":"static/js/4.3927ada2.chunk.js","sourcesContent":["import * as React from 'react';\nimport { connect } from 'react-redux';\nimport { AppState } from '../../../store';\nimport { Typography } from '@material-ui/core';\n\nexport interface TablePlaceholderProps {\n  name?: string;\n  tab?: string;\n  placeholder?: string; //optional placeholder text\n  renderPlaceholder?: (props: TablePlaceholderProps) => React.Component;\n  primary?: string;\n  secondary?: string;\n  classes?: any;\n}\n\nconst TablePlaceholder = (props: TablePlaceholderProps) => {\n  const { primary, secondary, renderPlaceholder } = props;\n\n  return renderPlaceholder ? (\n    renderPlaceholder(props)\n  ) : (\n    <>\n      {primary && (\n        <Typography color='textSecondary' variant='subtitle1' style={{ padding: 16 }} align='center'>\n          {primary}\n        </Typography>\n      )}\n      {secondary && (\n        <Typography color='textSecondary' variant='body1' style={{ padding: 16 }} align='center'>\n          {secondary}\n        </Typography>\n      )}\n    </>\n  );\n};\n\nconst mapStateToProps = (state: AppState, ownProp: TablePlaceholderProps): TablePlaceholderProps => {\n  const { name, placeholder } = ownProp;\n  const table = state.table[name];\n  const primary = ownProp.primary || `No ${name}`;\n  const secondary = ownProp.secondary || placeholder;\n  return {\n    ...ownProp,\n    tab: table && table.tab && table.tab,\n    primary,\n    secondary\n  };\n};\n\nexport default connect(mapStateToProps)(TablePlaceholder as any) as any;\n","import * as React from 'react';\nimport * as Icons from '@material-ui/icons';\nimport { makeStyles, useTheme, Typography, Collapse, Checkbox, Grid, createStyles } from '@material-ui/core';\nimport MuiTable from 'mui-virtualized-table';\nimport AutoSizer from 'react-virtualized/dist/commonjs/AutoSizer';\nimport Component from '@reactions/component';\nimport classNames from 'classnames';\nimport * as TableStore from './store';\nimport { SortComparator } from './helpers';\nimport { evalFunc } from '../../../helpers';\n\nexport interface VirtualTableProps {\n  name?: string;\n  height?: number;\n  checkbox?: boolean;\n  hover?: boolean;\n  onCellClick?: (event, props) => any;\n  onHeaderClick?: (event, props) => any;\n  isCellHovered?: (column, rowData, hoveredColumn, hoveredRowData) => boolean;\n  select?: boolean;\n  columns?: any[] | ((props?) => any[]);\n  data?: any[];\n  MultiSelectToolbar?: any;\n  rounded?: boolean;\n  rowHeight?: number;\n  includeHeaders?: boolean;\n  fixedRowCount?: number;\n  fixedColumnCount?: number;\n  showScroll?: boolean;\n  rowDivider?: boolean;\n}\n\nconst gridStyle = {\n  border: 0,\n  'scrollbar-width': 'none' /* Firefox 64 */\n};\n\nconst sharedTableStyle = {\n  border: 0,\n  '& .topLeftGrid': gridStyle,\n  '& .topRightGrid': gridStyle,\n  '& .bottomLeftGrid': gridStyle\n};\n\nconst tableStyle = {\n  ...sharedTableStyle,\n  '& .bottomRightGrid': {\n    border: 0,\n    // Hide scrollbars on Chrome/Safari/IE\n    '&::-webkit-scrollbar': {\n      display: 'none'\n    },\n    'scrollbar-width': 'none' /* Firefox 64 */,\n    '-ms-overflow-style': 'none' as any,\n    '-webkit-overflow-scrolling': 'auto',\n    '&::-webkit-overflow-scrolling': 'auto'\n  }\n};\n\nexport const tableScrollStyle = ({ palette }) => ({\n  ...sharedTableStyle,\n  '& .bottomRightGrid': {\n    '&::-webkit-scrollbar': {\n      display: 'auto',\n      width: 6,\n      height: 6\n    },\n    '&::-webkit-scrollbar-thumb': {\n      // Works on chrome only\n      backgroundColor: palette.primary.light,\n      borderRadius: 25\n    },\n    border: 0,\n    '-ms-overflow-style': 'none' as any,\n    '-webkit-overflow-scrolling': 'auto',\n    '&::-webkit-overflow-scrolling': 'auto'\n  }\n});\n\nconst useStyles = makeStyles(({ palette, spacing, layout }: any) =>\n  createStyles({\n    table: {\n      ...tableStyle\n    },\n    tableRounded: {\n      borderBottomLeftRadius: 12,\n      borderBottomRightRadius: 12,\n      ...tableStyle\n    },\n    tableScroll: {\n      ...tableScrollStyle({ palette })\n    },\n    tableScrollRounded: {\n      borderBottomLeftRadius: 12,\n      borderBottomRightRadius: 12,\n      ...tableScrollStyle({ palette })\n    },\n    cellHovered: {\n      backgroundColor: palette.primary.light\n    },\n    cellSelected: {\n      color: palette.common.white + ' !important',\n      backgroundColor: palette.primary.main\n    },\n    checkbox: {\n      paddingLeft: 0,\n      paddingRight: 0\n    },\n    checkboxIcon: {\n      backgroundColor: palette.common.white\n    },\n    selectedHeader: {\n      paddingLeft: spacing(1),\n      paddingRight: spacing(1),\n      color: palette.common.white,\n      backgroundColor: palette.primary.main,\n      height: layout.multiselectbarheight,\n      marginBottom: layout.contentrowspacing\n    },\n    cell: {\n      //color: palette.secondary.main,\n    },\n    collapse: {\n      background: palette.grey[400]\n    }\n  })\n);\n\n//If a row data function exists, it returns the results of that, otherwise just the row id\nexport function getRowData(selectedRowIds, data) {\n  return selectedRowIds\n    .map(rid => data.find(d => d.id === rid))\n    .filter(row => row)\n    .map(row => (row.getRowData ? { ...row.getRowData(row) } : { id: row.id }));\n}\n\nexport default function VirtualTable(props: VirtualTableProps) {\n  const classes = useStyles(props);\n  const { layout } = useTheme() as any;\n  const {\n    name,\n    includeHeaders = true,\n    fixedRowCount = 1,\n    fixedColumnCount = 0,\n    rowHeight = layout.tableRowHeight,\n    rounded = false,\n    hover,\n    onCellClick = undefined,\n    onHeaderClick = undefined,\n    isCellHovered = undefined,\n    select,\n    checkbox,\n    data,\n    height,\n    columns,\n    MultiSelectToolbar,\n    showScroll = false,\n    rowDivider = true\n  } = props;\n\n  const table: TableStore.Table = TableStore.useTable(name);\n  const tableUpdate = TableStore.useTableUpdate();\n\n  const handleSort = (column, sort: SortComparator) => {\n    table &&\n      tableUpdate({\n        id: table.id,\n        orderBy: column,\n        orderDirection: table.orderDirection === 'asc' ? 'desc' : 'asc',\n        sortComparator: sort\n      });\n  };\n\n  const sortinjectedcolumns = evalFunc(columns, props).map(c => ({\n    ...c,\n    onHeaderClick: c.sort\n      ? (event, props) => {\n          handleSort(c.name, c.sort);\n          onHeaderClick && onHeaderClick(event, props);\n        }\n      : onHeaderClick\n  })); //;== true && handleSort() }));\n  return (\n    <div style={{ height: height }}>\n      <Component initialState={{ selectedRowIds: [] }}>\n        {({ state, setState }) => {\n          const selectedRowIds = state.selectedRowIds;\n          const length = selectedRowIds.length;\n          const itemtxt = length === 0 ? '' : length === 1 ? length + ' item' : length + ' items';\n          const adjustedheight = length > 0 ? height - layout.multiselectbarheight - layout.contentrowspacing : height;\n          return (\n            <AutoSizer>\n              {({ width }) => (\n                <>\n                  <div style={{ width: width }}>\n                    <Collapse className={classes.collapse} in={length > 0}>\n                      <Grid className={classes.selectedHeader} container direction='row' justify='space-between' alignItems='center' spacing={0}>\n                        <Grid item xs zeroMinWidth>\n                          <Typography noWrap color='inherit' variant='h5'>\n                            {itemtxt}\n                          </Typography>\n                        </Grid>\n                        <Grid item xs>\n                          <Grid container justify='flex-end' alignItems='center' alignContent='center'>\n                            <Grid item>{length > 0 && MultiSelectToolbar && <MultiSelectToolbar rowData={getRowData(selectedRowIds, data)} />}</Grid>\n                          </Grid>\n                        </Grid>\n                      </Grid>\n                    </Collapse>\n                  </div>\n                  <MuiTable\n                    cellProps={{\n                      size: 'small',\n                      style: { paddingLeft: 16, paddingRight: 0, borderBottom: rowDivider === false ? 0 : undefined }\n                    }}\n                    classes={{\n                      table: showScroll\n                        ? classNames(classes.tableScroll, rounded && classes.tableScrollRounded)\n                        : classNames(classes.table, rounded && classes.tableRounded),\n                      cellHovered: classes.cellHovered,\n                      cellSelected: classes.cellSelected,\n                      cell: classes.cell\n                    }}\n                    fixedRowCount={fixedRowCount}\n                    fixedColumnCount={fixedColumnCount}\n                    width={width}\n                    height={adjustedheight}\n                    rowHeight={rowHeight}\n                    includeHeaders={includeHeaders}\n                    orderBy={table && table.orderBy}\n                    orderDirection={table ? table.orderDirection : 'asc'}\n                    data={data}\n                    columns={\n                      checkbox\n                        ? [\n                            {\n                              name: 'checkbox',\n                              header: (\n                                <Checkbox\n                                  checkedIcon={<Icons.CheckBox className={classes.checkboxIcon} color='primary' />}\n                                  indeterminateIcon={<Icons.IndeterminateCheckBox className={classes.checkboxIcon} color='primary' />}\n                                  checked={state.selectedRowIds.filter(rid => data.find(d => d.id === rid)).length > 0}\n                                  onChange={e =>\n                                    setState(prevState => {\n                                      if (prevState.selectedRowIds.filter(rid => data.find(d => d.id === rid)).length === data.length) {\n                                        // deselect all\n                                        return { selectedRowIds: [] };\n                                      } else {\n                                        // select all\n                                        return {\n                                          selectedRowIds: data.map(d => d.id)\n                                        };\n                                      }\n                                    })\n                                  }\n                                  {...(state.selectedRowIds.filter(rid => data.find(d => d.id === rid)).length > 0 &&\n                                    state.selectedRowIds.filter(rid => data.find(d => d.id === rid)).length !== data.length && {\n                                      indeterminate: true,\n                                      color: 'default'\n                                    })}\n                                />\n                              ),\n                              cell: rowData => (\n                                <Checkbox\n                                  checkedIcon={<Icons.CheckBox className={classes.checkboxIcon} color='primary' />}\n                                  checked={state.selectedRowIds.filter(rid => data.find(d => d.id === rid)).some(id => rowData.id === id)}\n                                />\n                              ),\n                              cellProps: {\n                                style: { paddingLeft: 8, paddingRight: 0 }\n                              },\n                              width: 48\n                            },\n                            ...sortinjectedcolumns\n                          ]\n                        : sortinjectedcolumns\n                    }\n                    isCellSelected={select ? (column, rowData) => state.selectedRowIds.some(id => rowData && rowData.id === id) : undefined}\n                    isCellHovered={\n                      isCellHovered || hover\n                        ? (column, rowData, hoveredColumn, hoveredRowData) =>\n                            isCellHovered\n                              ? isCellHovered(column, rowData, hoveredColumn, hoveredRowData)\n                              : rowData && rowData.id && rowData.id === hoveredRowData.id\n                        : undefined\n                    }\n                    onHeaderClick={onHeaderClick}\n                    onCellClick={\n                      onCellClick\n                        ? onCellClick\n                        : select\n                        ? (event, { column, rowData }) => {\n                            setState(prevState => {\n                              if (prevState.selectedRowIds.some(id => rowData.id === id)) {\n                                // remove\n                                return {\n                                  selectedRowIds: prevState.selectedRowIds.filter(id => id !== rowData.id)\n                                };\n                              } else {\n                                // add\n                                return {\n                                  selectedRowIds: [...prevState.selectedRowIds, rowData.id]\n                                };\n                              }\n                            });\n                          }\n                        : undefined\n                    }\n                    style={{ backgroundColor: 'white' }}\n                  />\n                </>\n              )}\n            </AutoSizer>\n          );\n        }}\n      </Component>\n    </div>\n  );\n}\n","import * as React from 'react';\nimport { Card, CardContent, CardMedia, createStyles, Grid, makeStyles, Typography } from '@material-ui/core';\nimport { getDayTimeFromTimestamp, isEmpty, lineClamp, publicUrl, stripContent } from '../../../helpers';\nimport { useHandleChangeRoute } from '../../layout/hooks';\nimport { getAppCompany, getAppIcon, getAppName } from './Applications/selectors';\nimport PlatformButtons from './ApplicationsSummary/PlatformButtons';\nimport DialogButton from '../GenericDialog/DialogButton';\n\nconst height = 520;\nconst useStyles = makeStyles(theme =>\n  createStyles({\n    root: {\n      flex: '1',\n      textAlign: 'center',\n      height,\n      borderRadius: 10,\n      transition: 'transform 0.15s ease-in-out',\n      '&:hover': {\n        transform: 'scale3d(1.025, 1.025, 1)'\n      },\n      cursor: 'pointer'\n    },\n    cardContent: {\n      paddingTop: 8,\n      paddingBottom: 0\n    },\n    media: {\n      borderBottom: `1px solid ${theme.palette.grey[400]}`\n    },\n    wrapper: {\n      height: height - 200,\n      overflow: 'hidden',\n      color: theme.palette.text.primary,\n      fontFamily: theme.typography.fontFamily,\n      '& h2': {\n        fontSize: theme.typography.h2.fontSize,\n        fontWeight: theme.typography.fontWeightBold,\n        lineHeight: theme.typography.h2.lineHeight,\n        marginBottom: theme.spacing(3)\n      },\n      '& h3': {\n        fontSize: theme.typography.h3.fontSize,\n        fontWeight: theme.typography.fontWeightBold,\n        lineHeight: theme.typography.h3.lineHeight,\n        marginBottom: theme.spacing(3)\n      },\n      '& p': {\n        fontSize: theme.typography.body1.fontSize,\n        lineHeight: theme.typography.body1.lineHeight,\n        marginBottom: 8,\n        marginTop: 8\n      },\n      '& li': {\n        fontSize: theme.typography.body1.fontSize,\n        lineHeight: theme.typography.body1.lineHeight,\n        marginBottom: theme.spacing(1)\n      }\n    }\n  })\n);\n\nexport default function ExploreGridItem(props: any) {\n  const {\n    name = getAppName(props),\n    company = getAppCompany(props),\n    platforms = [],\n    costs = [],\n    androidLink,\n    iosLink,\n    androidStore,\n    appleStore,\n    webLink,\n    icon = getAppIcon(props),\n    created,\n    updated,\n    children = undefined\n  } = props;\n\n  const [state, setState] = React.useState({\n    raised: false\n  });\n\n  const classes = useStyles();\n  const handleChangeRoute = useHandleChangeRoute();\n\n  const content = !isEmpty(appleStore?.description) ? appleStore.description : androidStore?.description;\n\n  return children ? (\n    <Card className={classes.root}>\n      <CardContent>{children}</CardContent>\n    </Card>\n  ) : (\n    <Card\n      onClick={handleChangeRoute(publicUrl('/ViewApp'), { app: props, from: 'ApplicationSummary' })}\n      className={classes.root}\n      onMouseOver={() => setState({ raised: true })}\n      onMouseOut={() => setState({ raised: false })}\n      raised={state.raised}\n      elevation={state.raised ? 8 : 4}\n    >\n      <CardMedia className={classes.media} image={icon} component='img' height='200' width='100%' alt='cover image' />\n      <CardContent className={classes.cardContent}>\n        <Grid container>\n          <Grid item xs={12}>\n            <Grid container>\n              <Grid item xs={12}>\n                <Typography variant='h5' noWrap>\n                  {name || 'Unknown Name'}\n                </Typography>\n              </Grid>\n              <Grid item xs={12}>\n                <Typography color='textSecondary' noWrap>\n                  {company}\n                </Typography>\n              </Grid>\n              <Grid item xs={12}>\n                <Grid container justify='center' spacing={0}>\n                  <Grid item>\n                    <PlatformButtons platforms={platforms} androidLink={androidLink} iosLink={iosLink} webLink={webLink} />\n                  </Grid>\n                  <Grid item xs={12}>\n                    <Typography noWrap color='textSecondary' variant='caption'>\n                      {costs.length === 0 ? (\n                        'Unknown Cost'\n                      ) : costs.length > 2 ? (\n                        <DialogButton variant='link' size='small' Icon={null} tooltip={costs.join(' | ')}>\n                          Multiple Associated Costs\n                        </DialogButton>\n                      ) : (\n                        costs.join(' | ')\n                      )}\n                    </Typography>\n                  </Grid>\n                </Grid>\n              </Grid>\n            </Grid>\n          </Grid>\n        </Grid>\n        <div className={classes.wrapper}>\n          <div dangerouslySetInnerHTML={{ __html: lineClamp(stripContent(content), 7) }} />\n          <Grid container style={{ marginTop: 4 }}>\n            <Grid item xs={12}>\n              <Typography noWrap display='block' align='right' color='textSecondary' variant='caption'>\n                Last Rating: {updated ? getDayTimeFromTimestamp(updated) : created ? getDayTimeFromTimestamp(created) : ''}\n              </Typography>\n            </Grid>\n          </Grid>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","import { ListRange } from './interfaces'\n\nexport function tupleComparator(prev: [any, any] | undefined, current: [any, any]) {\n  return !!(prev && prev[0] === current[0] && prev[1] === current[1])\n}\n\nexport function rangeComparator(prev: ListRange | undefined, next: ListRange) {\n  return !!(prev && prev.startIndex === next.startIndex && prev.endIndex === next.endIndex)\n}\n","import * as u from '@virtuoso.dev/urx'\n\nexport const domIOSystem = u.system(\n  () => {\n    const scrollContainerState = u.stream<[number, number]>()\n    const scrollTop = u.stream<number>()\n    const deviation = u.statefulStream(0)\n    const smoothScrollTargetReached = u.stream<true>()\n    const statefulScrollTop = u.statefulStream(0)\n    const viewportHeight = u.stream<number>()\n    const scrollHeight = u.stream<number>()\n    const headerHeight = u.statefulStream(0)\n    const footerHeight = u.statefulStream(0)\n    const scrollTo = u.stream<ScrollToOptions>()\n    const scrollBy = u.stream<ScrollToOptions>()\n    const scrollingInProgress = u.statefulStream(false)\n\n    u.connect(\n      u.pipe(\n        scrollContainerState,\n        u.map(([scrollTop]) => scrollTop)\n      ),\n      scrollTop\n    )\n\n    u.connect(\n      u.pipe(\n        scrollContainerState,\n        u.map(([, scrollHeight]) => scrollHeight)\n      ),\n      scrollHeight\n    )\n\n    u.connect(scrollTop, statefulScrollTop)\n\n    return {\n      // input\n      scrollContainerState,\n      scrollTop,\n      viewportHeight,\n      headerHeight,\n      footerHeight,\n      scrollHeight,\n      smoothScrollTargetReached,\n\n      // signals\n      scrollTo,\n      scrollBy,\n\n      // state\n      statefulScrollTop,\n      deviation,\n      scrollingInProgress,\n    }\n  },\n  [],\n  { singleton: true }\n)\n","import * as u from '@virtuoso.dev/urx'\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\ndeclare namespace globalThis {\n  let VIRTUOSO_LOG_LEVEL: LogLevel | undefined\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\ndeclare namespace window {\n  let VIRTUOSO_LOG_LEVEL: LogLevel | undefined\n}\n\nexport enum LogLevel {\n  DEBUG,\n  INFO,\n  WARN,\n  ERROR,\n}\nexport interface LogMessage {\n  level: LogLevel\n  message: any\n  label: string\n}\n\nexport type Log = (label: string, message: any, level?: LogLevel) => void\n\nconst CONSOLE_METHOD_MAP = {\n  [LogLevel.DEBUG]: 'debug',\n  [LogLevel.INFO]: 'log',\n  [LogLevel.WARN]: 'warn',\n  [LogLevel.ERROR]: 'error',\n} as const\n\nconst getGlobalThis = () => (typeof globalThis === 'undefined' ? window : globalThis)\n\nexport const loggerSystem = u.system(\n  () => {\n    const logLevel = u.statefulStream<LogLevel>(LogLevel.ERROR)\n    const log = u.statefulStream<Log>((label: string, message: any, level: LogLevel = LogLevel.INFO) => {\n      const currentLevel = getGlobalThis()['VIRTUOSO_LOG_LEVEL'] ?? u.getValue(logLevel)\n      if (level >= currentLevel) {\n        // eslint-disable-next-line no-console\n        console[CONSOLE_METHOD_MAP[level]](\n          '%creact-virtuoso: %c%s %o',\n          'color: #0253b3; font-weight: bold',\n          'color: initial',\n          label,\n          message\n        )\n      }\n    })\n\n    return {\n      log,\n      logLevel,\n    }\n  },\n  [],\n  { singleton: true }\n)\n","import * as u from '@virtuoso.dev/urx'\nimport { getValue, tup } from '@virtuoso.dev/urx'\nimport { loggerSystem, LogLevel } from './loggerSystem'\n\nexport const propsReadySystem = u.system(\n  ([{ log }]) => {\n    const propsReady = u.statefulStream(false)\n\n    const didMount = u.streamFromEmitter(\n      u.pipe(\n        propsReady,\n        u.filter((ready) => ready),\n        u.distinctUntilChanged()\n      )\n    )\n    u.subscribe(propsReady, (value) => {\n      value && getValue(log)('props updated', {}, LogLevel.DEBUG)\n    })\n\n    return { propsReady, didMount }\n  },\n  tup(loggerSystem),\n  { singleton: true }\n)\n","import * as u from '@virtuoso.dev/urx'\nimport { domIOSystem } from './domIOSystem'\n\nexport const UP = 'up' as const\nexport const DOWN = 'down' as const\nexport const NONE = 'none' as const\nexport type ScrollDirection = typeof UP | typeof DOWN | typeof NONE\n\nexport interface ListBottomInfo {\n  bottom: number\n  offsetBottom: number\n}\n\nexport interface AtBottomParams {\n  offsetBottom: number\n  scrollTop: number\n  viewportHeight: number\n  scrollHeight: number\n}\n\nexport type NotAtBottomReason =\n  | 'SIZE_INCREASED'\n  | 'NOT_SHOWING_LAST_ITEM'\n  | 'VIEWPORT_HEIGHT_DECREASING'\n  | 'SCROLLING_UPWARDS'\n  | 'NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM'\n\nexport type AtBottomReason = 'SIZE_DECREASED' | 'SCROLLED_DOWN'\n\nexport type AtBottomState =\n  | {\n      atBottom: false\n      notAtBottomBecause: NotAtBottomReason\n      state: AtBottomParams\n    }\n  | {\n      atBottom: true\n      state: AtBottomParams\n      atBottomBecause: AtBottomReason\n      scrollTopDelta: number\n    }\n\nconst INITIAL_BOTTOM_STATE = {\n  atBottom: false,\n  notAtBottomBecause: 'NOT_SHOWING_LAST_ITEM',\n  state: {\n    offsetBottom: 0,\n    scrollTop: 0,\n    viewportHeight: 0,\n    scrollHeight: 0,\n  },\n} as AtBottomState\n\nexport const stateFlagsSystem = u.system(([{ scrollContainerState, scrollTop, viewportHeight, headerHeight, footerHeight, scrollBy }]) => {\n  const isAtBottom = u.statefulStream(false)\n  const isAtTop = u.statefulStream(true)\n  const atBottomStateChange = u.stream<boolean>()\n  const atTopStateChange = u.stream<boolean>()\n  const atBottomThreshold = u.statefulStream(4)\n\n  // skip 1 to avoid an initial on/off flick\n  const isScrolling = u.streamFromEmitter(\n    u.pipe(\n      u.merge(u.pipe(u.duc(scrollTop), u.skip(1), u.mapTo(true)), u.pipe(u.duc(scrollTop), u.skip(1), u.mapTo(false), u.debounceTime(100))),\n      u.distinctUntilChanged()\n    )\n  )\n\n  const isScrollingBy = u.statefulStreamFromEmitter(\n    u.pipe(u.merge(u.pipe(scrollBy, u.mapTo(true)), u.pipe(scrollBy, u.mapTo(false), u.debounceTime(200))), u.distinctUntilChanged()),\n    false\n  )\n\n  // u.subscribe(isScrollingBy, (isScrollingBy) => console.log({ isScrollingBy }))\n\n  u.connect(\n    u.pipe(\n      u.duc(scrollTop),\n      u.map((top) => top === 0),\n      u.distinctUntilChanged()\n    ),\n    isAtTop\n  )\n\n  u.connect(isAtTop, atTopStateChange)\n\n  const atBottomState = u.streamFromEmitter(\n    u.pipe(\n      u.combineLatest(scrollContainerState, u.duc(viewportHeight), u.duc(headerHeight), u.duc(footerHeight), u.duc(atBottomThreshold)),\n      u.scan((current, [[scrollTop, scrollHeight], viewportHeight, _headerHeight, _footerHeight, atBottomThreshold]) => {\n        const isAtBottom = scrollTop + viewportHeight - scrollHeight > -atBottomThreshold\n        const state = {\n          viewportHeight,\n          scrollTop,\n          scrollHeight,\n        }\n\n        if (isAtBottom) {\n          let atBottomBecause: 'SIZE_DECREASED' | 'SCROLLED_DOWN'\n          let scrollTopDelta: number\n          if (scrollTop > current.state.scrollTop) {\n            atBottomBecause = 'SCROLLED_DOWN'\n            scrollTopDelta = current.state.scrollTop - scrollTop\n          } else {\n            atBottomBecause = 'SIZE_DECREASED'\n            scrollTopDelta = current.state.scrollTop - scrollTop || (current as { scrollTopDelta: number }).scrollTopDelta\n          }\n          return {\n            atBottom: true,\n            state,\n            atBottomBecause,\n            scrollTopDelta,\n          } as AtBottomState\n        }\n\n        let notAtBottomBecause: NotAtBottomReason\n\n        if (state.scrollHeight > current.state.scrollHeight) {\n          notAtBottomBecause = 'SIZE_INCREASED'\n        } else if (viewportHeight < current.state.viewportHeight) {\n          notAtBottomBecause = 'VIEWPORT_HEIGHT_DECREASING'\n        } else if (scrollTop < current.state.scrollTop) {\n          notAtBottomBecause = 'SCROLLING_UPWARDS'\n        } else {\n          notAtBottomBecause = 'NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM'\n        }\n\n        return {\n          atBottom: false,\n          notAtBottomBecause,\n          state,\n        } as AtBottomState\n      }, INITIAL_BOTTOM_STATE),\n      u.distinctUntilChanged((prev, next) => {\n        return prev && prev.atBottom === next.atBottom\n      })\n    )\n  )\n\n  const lastJumpDueToItemResize = u.statefulStreamFromEmitter(\n    u.pipe(\n      scrollContainerState,\n      u.scan(\n        (current, [scrollTop, scrollHeight]) => {\n          if (current.scrollHeight !== scrollHeight) {\n            if (current.scrollTop !== scrollTop) {\n              return {\n                scrollHeight,\n                scrollTop,\n                jump: current.scrollTop - scrollTop,\n                changed: true,\n              }\n            } else {\n              return {\n                scrollHeight,\n                scrollTop,\n                jump: 0,\n                changed: true,\n              }\n            }\n          } else {\n            return {\n              scrollTop,\n              scrollHeight,\n              jump: 0,\n              changed: false,\n            }\n          }\n        },\n        { scrollHeight: 0, jump: 0, scrollTop: 0, changed: false }\n      ),\n      u.filter((value) => value.changed),\n      u.map((value) => value.jump)\n    ),\n    0\n  )\n\n  u.connect(\n    u.pipe(\n      atBottomState,\n      u.map((state) => state.atBottom)\n    ),\n    isAtBottom\n  )\n\n  u.subscribe(isAtBottom, (value) => {\n    setTimeout(() => u.publish(atBottomStateChange, value))\n  })\n\n  const scrollDirection = u.statefulStream<ScrollDirection>(DOWN)\n\n  u.subscribe(isAtBottom, (value) => {\n    setTimeout(() => {\n      u.publish(atBottomStateChange, value)\n    })\n  })\n\n  u.connect(\n    u.pipe(\n      scrollContainerState,\n      u.map(([scrollTop]) => scrollTop),\n      u.distinctUntilChanged(),\n      u.scan(\n        (acc, scrollTop) => {\n          // if things change while compensating for items, ignore,\n          // but store the new scrollTop\n          if (u.getValue(isScrollingBy)) {\n            return { direction: acc.direction, prevScrollTop: scrollTop }\n          }\n\n          return { direction: scrollTop < acc.prevScrollTop ? UP : DOWN, prevScrollTop: scrollTop }\n        },\n        { direction: DOWN, prevScrollTop: 0 } as { direction: ScrollDirection; prevScrollTop: number }\n      ),\n      u.map((value) => value.direction)\n    ),\n    scrollDirection\n  )\n\n  u.connect(u.pipe(scrollContainerState, u.throttleTime(50), u.mapTo(NONE)), scrollDirection)\n\n  u.connect(isAtBottom, atBottomStateChange)\n\n  const scrollVelocity = u.statefulStream(0)\n\n  u.connect(\n    u.pipe(\n      isScrolling,\n      u.filter((value) => !value),\n      u.mapTo(0)\n    ),\n    scrollVelocity\n  )\n\n  u.connect(\n    u.pipe(\n      scrollTop,\n      u.throttleTime(100),\n      u.withLatestFrom(isScrolling),\n      u.filter(([_, isScrolling]) => !!isScrolling),\n      u.scan(([_, prev], [next]) => [prev, next], [0, 0]),\n      u.map(([prev, next]) => next - prev)\n    ),\n    scrollVelocity\n  )\n\n  return {\n    isScrolling,\n    isAtTop,\n    isAtBottom,\n    atBottomState,\n    atTopStateChange,\n    atBottomStateChange,\n    scrollDirection,\n    atBottomThreshold,\n    scrollVelocity,\n    lastJumpDueToItemResize,\n  }\n}, u.tup(domIOSystem))\n","import * as u from '@virtuoso.dev/urx'\nimport { ListRange } from './interfaces'\nimport { stateFlagsSystem } from './stateFlagsSystem'\nimport { ScrollSeekConfiguration } from './interfaces'\n\nexport const scrollSeekSystem = u.system(\n  ([{ scrollVelocity }]) => {\n    const isSeeking = u.statefulStream(false)\n    const rangeChanged = u.stream<ListRange>()\n    const scrollSeekConfiguration = u.statefulStream<ScrollSeekConfiguration | undefined | false>(false)\n\n    u.connect(\n      u.pipe(\n        scrollVelocity,\n        u.withLatestFrom(scrollSeekConfiguration, isSeeking, rangeChanged),\n        u.filter(([_, config]) => !!config),\n        u.map(([speed, config, isSeeking, range]) => {\n          const { exit, enter } = config as ScrollSeekConfiguration\n          if (isSeeking) {\n            if (exit(speed, range)) {\n              return false\n            }\n          } else {\n            if (enter(speed, range)) {\n              return true\n            }\n          }\n          return isSeeking\n        }),\n        u.distinctUntilChanged()\n      ),\n      isSeeking\n    )\n\n    u.subscribe(\n      u.pipe(u.combineLatest(isSeeking, scrollVelocity, rangeChanged), u.withLatestFrom(scrollSeekConfiguration)),\n      ([[isSeeking, velocity, range], config]) => isSeeking && config && config.change && config.change(velocity, range)\n    )\n\n    return { isSeeking, scrollSeekConfiguration, scrollVelocity, scrollSeekRangeChanged: rangeChanged }\n  },\n  u.tup(stateFlagsSystem),\n  { singleton: true }\n)\n","interface NilNode {\n  lvl: 0\n}\n\nconst NIL_NODE: NilNode = { lvl: 0 }\n\ninterface NodeData<T> {\n  k: number\n  v: T\n}\n\ninterface NonNilAANode<T> {\n  k: number\n  v: T\n  lvl: number\n  l: NonNilAANode<T> | NilNode\n  r: NonNilAANode<T> | NilNode\n}\n\nexport interface Range<T> {\n  start: number\n  end: number\n  value: T\n}\n\nexport type AANode<T> = NilNode | NonNilAANode<T>\n\nfunction newAANode<T>(k: number, v: T, lvl: number, l: AANode<T> = NIL_NODE, r: AANode<T> = NIL_NODE): NonNilAANode<T> {\n  return { k, v, lvl, l, r }\n}\n\nexport function empty(node: AANode<any>): node is NilNode {\n  return node === NIL_NODE\n}\n\nexport function newTree<T>(): AANode<T> {\n  return NIL_NODE\n}\n\nexport function remove<T>(node: AANode<T>, key: number): AANode<T> {\n  if (empty(node)) return NIL_NODE\n\n  const { k, l, r } = node\n\n  if (key === k) {\n    if (empty(l)) {\n      return r\n    } else if (empty(r)) {\n      return l\n    } else {\n      const [lastKey, lastValue] = last(l)\n      return adjust(clone(node, { k: lastKey, v: lastValue, l: deleteLast(l) }))\n    }\n  } else if (key < k) {\n    return adjust(clone(node, { l: remove(l, key) }))\n  } else {\n    return adjust(clone(node, { r: remove(r, key) }))\n  }\n}\n\nexport function find<T>(node: AANode<T>, key: number): T | undefined {\n  if (empty(node)) {\n    return\n  }\n\n  if (key === node.k) {\n    return node.v\n  } else if (key < node.k) {\n    return find(node.l, key)\n  } else {\n    return find(node.r, key)\n  }\n}\n\nexport function findMaxKeyValue<T>(node: AANode<T>, value: number, field: 'k' | 'v' = 'k'): [number, T | undefined] {\n  if (empty(node)) {\n    return [-Infinity, undefined]\n  }\n\n  if (node[field] === value) {\n    return [node.k, node.v]\n  }\n\n  if (node[field] < value) {\n    const r = findMaxKeyValue(node.r, value, field)\n    if (r[0] === -Infinity) {\n      return [node.k, node.v]\n    } else {\n      return r\n    }\n  }\n\n  return findMaxKeyValue(node.l, value, field)\n}\n\nexport function insert<T>(node: AANode<T>, k: number, v: T): NonNilAANode<T> {\n  if (empty(node)) {\n    return newAANode(k, v, 1)\n  }\n  if (k === node.k) {\n    return clone(node, { k, v })\n  } else if (k < node.k) {\n    return rebalance(clone(node, { l: insert(node.l, k, v) }))\n  } else {\n    return rebalance(clone(node, { r: insert(node.r, k, v) }))\n  }\n}\n\nexport function walkWithin<T>(node: AANode<T>, start: number, end: number): NodeData<T>[] {\n  if (empty(node)) {\n    return []\n  }\n\n  const { k, v, l, r } = node\n  let result: NodeData<T>[] = []\n  if (k > start) {\n    result = result.concat(walkWithin(l, start, end))\n  }\n\n  if (k >= start && k <= end) {\n    result.push({ k, v })\n  }\n\n  if (k <= end) {\n    result = result.concat(walkWithin(r, start, end))\n  }\n\n  return result\n}\n\nexport function walk<T>(node: AANode<T>): NodeData<T>[] {\n  if (empty(node)) {\n    return []\n  }\n\n  return [...walk(node.l), { k: node.k, v: node.v }, ...walk(node.r)]\n}\n\nfunction last<T>(node: NonNilAANode<T>): [number, T] {\n  return empty(node.r) ? [node.k, node.v] : last(node.r)\n}\n\nfunction deleteLast<T>(node: NonNilAANode<T>): AANode<T> {\n  return empty(node.r) ? node.l : adjust(clone(node, { r: deleteLast(node.r) }))\n}\n\nfunction clone<T>(node: NonNilAANode<T>, args: Partial<NonNilAANode<T>>): NonNilAANode<T> {\n  return newAANode(\n    args.k !== undefined ? args.k : node.k,\n    args.v !== undefined ? args.v : node.v,\n    args.lvl !== undefined ? args.lvl : node.lvl,\n    args.l !== undefined ? args.l : node.l,\n    args.r !== undefined ? args.r : node.r\n  )\n}\n\nfunction isSingle(node: AANode<any>) {\n  return empty(node) || node.lvl > node.r.lvl\n}\n\nfunction rebalance<T>(node: NonNilAANode<T>): NonNilAANode<T> {\n  return split(skew(node))\n}\n\nfunction adjust<T>(node: NonNilAANode<T>): NonNilAANode<T> {\n  const { l, r, lvl } = node\n  if (r.lvl >= lvl - 1 && l.lvl >= lvl - 1) {\n    return node\n  } else if (lvl > r.lvl + 1) {\n    if (isSingle(l)) {\n      return skew(clone(node, { lvl: lvl - 1 }))\n    } else {\n      if (!empty(l) && !empty(l.r)) {\n        return clone(l.r, {\n          l: clone(l, { r: l.r.l }),\n          r: clone(node, {\n            l: l.r.r,\n            lvl: lvl - 1,\n          }),\n          lvl: lvl,\n        })\n      } else {\n        throw new Error('Unexpected empty nodes')\n      }\n    }\n  } else {\n    if (isSingle(node)) {\n      return split(clone(node, { lvl: lvl - 1 }))\n    } else {\n      if (!empty(r) && !empty(r.l)) {\n        const rl = r.l\n        const rlvl = isSingle(rl) ? r.lvl - 1 : r.lvl\n\n        return clone(rl, {\n          l: clone(node, {\n            r: rl.l,\n            lvl: lvl - 1,\n          }),\n          r: split(clone(r, { l: rl.r, lvl: rlvl })),\n          lvl: rl.lvl + 1,\n        })\n      } else {\n        throw new Error('Unexpected empty nodes')\n      }\n    }\n  }\n}\n\nexport function keys(node: AANode<any>): number[] {\n  if (empty(node)) {\n    return []\n  }\n  return [...keys(node.l), node.k, ...keys(node.r)]\n}\n\nexport function ranges<T>(node: AANode<T>): Range<T>[] {\n  return toRanges(walk(node))\n}\n\nexport function rangesWithin<T>(node: AANode<T>, startIndex: number, endIndex: number): Range<T>[] {\n  if (empty(node)) {\n    return []\n  }\n  const adjustedStart = findMaxKeyValue(node, startIndex)[0]\n  return toRanges(walkWithin(node, adjustedStart, endIndex))\n}\n\nexport function arrayToRanges<T, V>(\n  items: T[],\n  parser: (item: T) => { index: number; value: V }\n): Array<{ start: number; end: number; value: V }> {\n  const length = items.length\n  if (length === 0) {\n    return []\n  }\n\n  let { index: start, value } = parser(items[0])\n\n  const result = []\n\n  for (let i = 1; i < length; i++) {\n    const { index: nextIndex, value: nextValue } = parser(items[i])\n    result.push({ start, end: nextIndex - 1, value })\n\n    start = nextIndex\n    value = nextValue\n  }\n\n  result.push({ start, end: Infinity, value })\n  return result\n}\n\nfunction toRanges<T>(nodes: NodeData<T>[]): Range<T>[] {\n  return arrayToRanges(nodes, ({ k: index, v: value }) => ({ index, value }))\n}\n\nfunction split<T>(node: NonNilAANode<T>): NonNilAANode<T> {\n  const { r, lvl } = node\n\n  return !empty(r) && !empty(r.r) && r.lvl === lvl && r.r.lvl === lvl ? clone(r, { l: clone(node, { r: r.l }), lvl: lvl + 1 }) : node\n}\n\nfunction skew<T>(node: NonNilAANode<T>): NonNilAANode<T> {\n  const { l } = node\n\n  return !empty(l) && l.lvl === node.lvl ? clone(l, { r: clone(node, { l: l.r }) }) : node\n}\n","export type Comparator<T> = {\n  (item: T, value: number): -1 | 0 | 1\n}\n\nexport function findIndexOfClosestSmallerOrEqual<T>(items: T[], value: number, comparator: Comparator<T>, start = 0): number {\n  let end = items.length - 1\n\n  while (start <= end) {\n    const index = Math.floor((start + end) / 2)\n    const item = items[index]\n    const match = comparator(item, value)\n    if (match === 0) {\n      return index\n    }\n\n    if (match === -1) {\n      if (end - start < 2) {\n        return index - 1\n      }\n      end = index - 1\n    } else {\n      if (end === start) {\n        return index\n      }\n      start = index + 1\n    }\n  }\n\n  throw new Error(`Failed binary finding record in array - ${items.join(',')}, searched for ${value}`)\n}\n\nexport function findClosestSmallerOrEqual<T>(items: T[], value: number, comparator: Comparator<T>): T {\n  return items[findIndexOfClosestSmallerOrEqual(items, value, comparator)]\n}\n\nexport function findRange<T>(items: T[], startValue: number, endValue: number, comparator: Comparator<T>): T[] {\n  const startIndex = findIndexOfClosestSmallerOrEqual(items, startValue, comparator)\n  const endIndex = findIndexOfClosestSmallerOrEqual(items, endValue, comparator, startIndex)\n  return items.slice(startIndex, endIndex + 1)\n}\n","export function correctItemSize(el: HTMLElement, dimension: 'height' | 'width') {\n  return Math.round(el.getBoundingClientRect()[dimension])\n}\n","import * as u from '@virtuoso.dev/urx'\nimport { arrayToRanges, AANode, empty, findMaxKeyValue, insert, newTree, Range, rangesWithin, remove, walk } from './AATree'\nimport * as arrayBinarySearch from './utils/binaryArraySearch'\nimport { correctItemSize } from './utils/correctItemSize'\nimport { loggerSystem, Log, LogLevel } from './loggerSystem'\n\nexport interface SizeRange {\n  startIndex: number\n  endIndex: number\n  size: number\n}\n\nexport type Data = readonly unknown[] | undefined\n\nfunction rangeIncludes(refRange: SizeRange) {\n  const { size, startIndex, endIndex } = refRange\n  return (range: Range<number>) => {\n    return range.start === startIndex && (range.end === endIndex || range.end === Infinity) && range.value === size\n  }\n}\n\nexport function insertRanges(sizeTree: AANode<number>, ranges: SizeRange[]) {\n  let syncStart = empty(sizeTree) ? 0 : Infinity\n\n  for (const range of ranges) {\n    const { size, startIndex, endIndex } = range\n    syncStart = Math.min(syncStart, startIndex)\n\n    if (empty(sizeTree)) {\n      sizeTree = insert(sizeTree, 0, size)\n      continue\n    }\n\n    // extend the range in both directions, so that we can get adjacent neighbours.\n    // if the previous / next ones have the same value as the one we are about to insert,\n    // we 'merge' them.\n    const overlappingRanges = rangesWithin(sizeTree, startIndex - 1, endIndex + 1)\n\n    if (overlappingRanges.some(rangeIncludes(range))) {\n      continue\n    }\n\n    let firstPassDone = false\n    let shouldInsert = false\n    for (const { start: rangeStart, end: rangeEnd, value: rangeValue } of overlappingRanges) {\n      // previous range\n      if (!firstPassDone) {\n        shouldInsert = rangeValue !== size\n        firstPassDone = true\n      } else {\n        // remove the range if it starts within the new range OR if\n        // it has the same value as it, in order to perform a merge\n        if (endIndex >= rangeStart || size === rangeValue) {\n          sizeTree = remove(sizeTree, rangeStart)\n        }\n      }\n\n      // next range\n      if (rangeEnd > endIndex && endIndex >= rangeStart) {\n        if (rangeValue !== size) {\n          sizeTree = insert(sizeTree, endIndex + 1, rangeValue)\n        }\n      }\n    }\n\n    if (shouldInsert) {\n      sizeTree = insert(sizeTree, startIndex, size)\n    }\n  }\n  return [sizeTree, syncStart] as const\n}\n\nexport interface OffsetPoint {\n  offset: number\n  size: number\n  index: number\n}\n\nexport interface SizeState {\n  sizeTree: AANode<number>\n  offsetTree: Array<OffsetPoint>\n  groupOffsetTree: AANode<number>\n  lastIndex: number\n  lastOffset: number\n  lastSize: number\n  groupIndices: number[]\n}\n\nexport function initialSizeState(): SizeState {\n  return {\n    offsetTree: [],\n    sizeTree: newTree<number>(),\n    groupOffsetTree: newTree<number>(),\n    lastIndex: 0,\n    lastOffset: 0,\n    lastSize: 0,\n    groupIndices: [],\n  }\n}\n\nexport function indexComparator({ index: itemIndex }: OffsetPoint, index: number) {\n  return index === itemIndex ? 0 : index < itemIndex ? -1 : 1\n}\n\nexport function offsetComparator({ offset: itemOffset }: OffsetPoint, offset: number) {\n  return offset === itemOffset ? 0 : offset < itemOffset ? -1 : 1\n}\n\nfunction offsetPointParser(point: OffsetPoint) {\n  return { index: point.index, value: point }\n}\n\nexport function rangesWithinOffsets(\n  tree: Array<OffsetPoint>,\n  startOffset: number,\n  endOffset: number,\n  minStartIndex = 0\n): Array<{\n  start: number\n  end: number\n  value: {\n    size: number\n    offset: number\n    index: number\n  }\n}> {\n  if (minStartIndex > 0) {\n    startOffset = Math.max(startOffset, arrayBinarySearch.findClosestSmallerOrEqual(tree, minStartIndex, indexComparator).offset)\n  }\n\n  return arrayToRanges(arrayBinarySearch.findRange(tree, startOffset, endOffset, offsetComparator), offsetPointParser)\n}\n\nexport function sizeStateReducer(state: SizeState, [ranges, groupIndices, log]: [SizeRange[], number[], Log]) {\n  if (ranges.length > 0) {\n    log('received item sizes', ranges, LogLevel.DEBUG)\n  }\n  const sizeTree = state.sizeTree\n  let offsetTree = state.offsetTree\n  let newSizeTree: AANode<number> = sizeTree\n  let syncStart = 0\n\n  // We receive probe item results from a group probe,\n  // which should always pass an item and a group\n  // the results contain two ranges, which we consider to mean that groups and items have different size\n  if (groupIndices.length > 0 && empty(sizeTree) && ranges.length === 2) {\n    const groupSize = ranges[0].size\n    const itemSize = ranges[1].size\n    newSizeTree = groupIndices.reduce((tree, groupIndex) => {\n      return insert(insert(tree, groupIndex, groupSize), groupIndex + 1, itemSize)\n    }, newSizeTree)\n  } else {\n    ;[newSizeTree, syncStart] = insertRanges(newSizeTree, ranges)\n  }\n\n  if (newSizeTree === sizeTree) {\n    return state\n  }\n\n  let prevIndex = 0\n  let prevSize = 0\n\n  let prevAOffset = 0\n  let startAIndex = 0\n\n  if (syncStart !== 0) {\n    startAIndex = arrayBinarySearch.findIndexOfClosestSmallerOrEqual(offsetTree, syncStart - 1, indexComparator)\n    const offsetInfo = offsetTree[startAIndex]\n    prevAOffset = offsetInfo.offset\n    const kv = findMaxKeyValue(newSizeTree, syncStart - 1)\n    prevIndex = kv[0]\n    prevSize = kv[1]!\n\n    if (offsetTree.length && offsetTree[startAIndex].size === findMaxKeyValue(newSizeTree, syncStart)[1]) {\n      startAIndex -= 1\n    }\n\n    offsetTree = offsetTree.slice(0, startAIndex + 1)\n  } else {\n    offsetTree = []\n  }\n\n  for (const { start: startIndex, value } of rangesWithin(newSizeTree, syncStart, Infinity)) {\n    const aOffset = (startIndex - prevIndex) * prevSize + prevAOffset\n    offsetTree.push({\n      offset: aOffset,\n      size: value,\n      index: startIndex,\n    })\n    prevIndex = startIndex\n    prevAOffset = aOffset\n    prevSize = value\n  }\n\n  return {\n    sizeTree: newSizeTree,\n    offsetTree,\n    groupOffsetTree: groupIndices.reduce((tree, index) => {\n      return insert(tree, index, offsetOf(index, offsetTree))\n    }, newTree<number>()),\n    lastIndex: prevIndex,\n    lastOffset: prevAOffset,\n    lastSize: prevSize,\n    groupIndices,\n  }\n}\n\nexport function offsetOf(index: number, tree: Array<OffsetPoint>) {\n  if (tree.length === 0) {\n    return 0\n  }\n\n  const { offset, index: startIndex, size } = arrayBinarySearch.findClosestSmallerOrEqual(tree, index, indexComparator)\n  return size * (index - startIndex) + offset\n}\n\nexport function originalIndexFromItemIndex(itemIndex: number, sizes: SizeState) {\n  if (!hasGroups(sizes)) {\n    return itemIndex\n  }\n\n  let groupOffset = 0\n  while (sizes.groupIndices[groupOffset] <= itemIndex + groupOffset) {\n    groupOffset++\n  }\n  // we find the real item index, offsetting it by the number of group items before it\n  return itemIndex + groupOffset\n}\n\nexport function hasGroups(sizes: SizeState) {\n  return !empty(sizes.groupOffsetTree)\n}\n\ntype OptionalNumber = number | undefined\n\nconst SIZE_MAP = {\n  offsetHeight: 'height',\n  offsetWidth: 'width',\n} as const\n\n/** Calculates the height of `el`, which will be the `Item` element in the DOM. */\nexport type SizeFunction = (el: HTMLElement, field: 'offsetHeight' | 'offsetWidth') => number\n\nexport const sizeSystem = u.system(\n  ([{ log }]) => {\n    const sizeRanges = u.stream<SizeRange[]>()\n    const totalCount = u.stream<number>()\n    const unshiftWith = u.stream<number>()\n    const firstItemIndex = u.statefulStream(0)\n    const groupIndices = u.statefulStream([] as number[])\n    const fixedItemSize = u.statefulStream<OptionalNumber>(undefined)\n    const defaultItemSize = u.statefulStream<OptionalNumber>(undefined)\n    const itemSize = u.statefulStream<SizeFunction>((el, field) => correctItemSize(el, SIZE_MAP[field]))\n    const data = u.statefulStream<Data>(undefined)\n    const initial = initialSizeState()\n\n    const sizes = u.statefulStreamFromEmitter(\n      u.pipe(sizeRanges, u.withLatestFrom(groupIndices, log), u.scan(sizeStateReducer, initial), u.distinctUntilChanged()),\n      initial\n    )\n\n    u.connect(\n      u.pipe(\n        groupIndices,\n        u.filter((indexes) => indexes.length > 0),\n        u.withLatestFrom(sizes),\n        u.map(([groupIndices, sizes]) => {\n          const groupOffsetTree = groupIndices.reduce((tree, index, idx) => {\n            return insert(tree, index, offsetOf(index, sizes.offsetTree) || idx)\n          }, newTree<number>())\n\n          return {\n            ...sizes,\n            groupIndices,\n            groupOffsetTree,\n          }\n        })\n      ),\n      sizes\n    )\n\n    // decreasing the total count should remove any existing entries\n    // beyond the last index - do this by publishing the default size as a range over them.\n    u.connect(\n      u.pipe(\n        totalCount,\n        u.withLatestFrom(sizes),\n        u.filter(([totalCount, { lastIndex }]) => {\n          return totalCount < lastIndex\n        }),\n        u.map(([totalCount, { lastIndex, lastSize }]) => {\n          return [\n            {\n              startIndex: totalCount,\n              endIndex: lastIndex,\n              size: lastSize,\n            },\n          ] as SizeRange[]\n        })\n      ),\n      sizeRanges\n    )\n\n    u.connect(fixedItemSize, defaultItemSize)\n\n    const trackItemSizes = u.statefulStreamFromEmitter(\n      u.pipe(\n        fixedItemSize,\n        u.map((size) => size === undefined)\n      ),\n      true\n    )\n\n    u.connect(\n      u.pipe(\n        defaultItemSize,\n        u.filter((value) => {\n          return value !== undefined && empty(u.getValue(sizes).sizeTree)\n        }),\n        u.map((size) => [{ startIndex: 0, endIndex: 0, size }] as SizeRange[])\n      ),\n      sizeRanges\n    )\n\n    const listRefresh = u.streamFromEmitter(\n      u.pipe(\n        sizeRanges,\n        u.withLatestFrom(sizes),\n        u.scan(\n          ({ sizes: oldSizes }, [_, newSizes]) => {\n            return {\n              changed: newSizes !== oldSizes,\n              sizes: newSizes,\n            }\n          },\n          { changed: false, sizes: initial }\n        ),\n        u.map((value) => value.changed)\n      )\n    )\n\n    u.connect(\n      u.pipe(\n        firstItemIndex,\n        u.scan(\n          (prev, next) => {\n            return { diff: prev.prev - next, prev: next }\n          },\n          { diff: 0, prev: 0 }\n        ),\n        u.map((val) => val.diff),\n        u.filter((value) => value > 0)\n      ),\n      unshiftWith\n    )\n\n    u.subscribe(u.pipe(firstItemIndex, u.withLatestFrom(log)), ([index, log]) => {\n      if (index < 0) {\n        log(\n          \"`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value\",\n          { firstItemIndex },\n          LogLevel.ERROR\n        )\n      }\n    })\n\n    // Capture the current list top item before the sizes get refreshed\n    const beforeUnshiftWith = u.streamFromEmitter(unshiftWith)\n\n    u.connect(\n      u.pipe(\n        unshiftWith,\n        u.withLatestFrom(sizes),\n        u.map(([unshiftWith, sizes]) => {\n          if (sizes.groupIndices.length > 0) {\n            throw new Error('Virtuoso: prepending items does not work with groups')\n          }\n\n          return walk(sizes.sizeTree).reduce(\n            (acc, { k: index, v: size }) => {\n              return {\n                ranges: [...acc.ranges, { startIndex: acc.prevIndex, endIndex: index + unshiftWith - 1, size: acc.prevSize }],\n                prevIndex: index + unshiftWith,\n                prevSize: size,\n              }\n            },\n            {\n              ranges: [] as SizeRange[],\n              prevIndex: 0,\n              prevSize: sizes.lastSize,\n            }\n          ).ranges\n        })\n      ),\n      sizeRanges\n    )\n\n    return {\n      // input\n      data,\n      totalCount,\n      sizeRanges,\n      groupIndices,\n      defaultItemSize,\n      fixedItemSize,\n      unshiftWith,\n      beforeUnshiftWith,\n      firstItemIndex,\n\n      // output\n      sizes,\n      listRefresh,\n      trackItemSizes,\n      itemSize,\n    }\n  },\n  u.tup(loggerSystem),\n  { singleton: true }\n)\n","/* eslint-disable @typescript-eslint/no-unsafe-call */\nimport * as u from '@virtuoso.dev/urx'\nimport { findMaxKeyValue } from './AATree'\nimport { domIOSystem } from './domIOSystem'\nimport { offsetOf, originalIndexFromItemIndex, sizeSystem } from './sizeSystem'\nimport { IndexLocationWithAlign } from './interfaces'\nimport { loggerSystem, LogLevel } from './loggerSystem'\n\nexport type IndexLocation = number | IndexLocationWithAlign\n\nconst SUPPORTS_SCROLL_TO_OPTIONS = typeof document !== 'undefined' && 'scrollBehavior' in document.documentElement.style\n\nexport function normalizeIndexLocation(location: IndexLocation) {\n  const result: IndexLocationWithAlign = typeof location === 'number' ? { index: location } : location\n\n  if (!result.align) {\n    result.align = 'start'\n  }\n  if (!result.behavior || !SUPPORTS_SCROLL_TO_OPTIONS) {\n    result.behavior = 'auto'\n  }\n  if (!result.offset) {\n    result.offset = 0\n  }\n  return result as Required<IndexLocationWithAlign>\n}\n\nexport const scrollToIndexSystem = u.system(\n  ([\n    { sizes, totalCount, listRefresh },\n    { scrollingInProgress, viewportHeight, scrollTo, smoothScrollTargetReached, headerHeight, footerHeight },\n    { log },\n  ]) => {\n    const scrollToIndex = u.stream<IndexLocation>()\n    const topListHeight = u.statefulStream(0)\n\n    let unsubscribeNextListRefresh: any = null\n    let cleartTimeoutRef: any = null\n    let unsubscribeListRefresh: any = null\n\n    function cleanup() {\n      if (unsubscribeNextListRefresh) {\n        unsubscribeNextListRefresh()\n        unsubscribeNextListRefresh = null\n      }\n\n      if (unsubscribeListRefresh) {\n        unsubscribeListRefresh()\n        unsubscribeListRefresh = null\n      }\n\n      if (cleartTimeoutRef) {\n        clearTimeout(cleartTimeoutRef)\n        cleartTimeoutRef = null\n      }\n      u.publish(scrollingInProgress, false)\n    }\n\n    u.connect(\n      u.pipe(\n        scrollToIndex,\n        u.withLatestFrom(sizes, viewportHeight, totalCount, topListHeight, headerHeight, footerHeight, log),\n        u.map(([location, sizes, viewportHeight, totalCount, topListHeight, headerHeight, footerHeight, log]) => {\n          const normalLocation = normalizeIndexLocation(location)\n          const { align, behavior, offset } = normalLocation\n          const lastIndex = totalCount - 1\n          let index = normalLocation.index\n          if (index === 'LAST') {\n            index = lastIndex\n          }\n\n          index = originalIndexFromItemIndex(index, sizes)\n\n          index = Math.max(0, index, Math.min(lastIndex, index))\n\n          let top = offsetOf(index, sizes.offsetTree) + headerHeight\n          if (align === 'end') {\n            top = top - viewportHeight + findMaxKeyValue(sizes.sizeTree, index)[1]!\n            if (index === lastIndex) {\n              top += footerHeight\n            }\n          } else if (align === 'center') {\n            top = top - viewportHeight / 2 + findMaxKeyValue(sizes.sizeTree, index)[1]! / 2\n          } else {\n            top -= topListHeight\n          }\n\n          if (offset) {\n            top += offset\n          }\n\n          const retry = (listChanged: boolean) => {\n            cleanup()\n            if (listChanged) {\n              log('retrying to scroll to', { location }, LogLevel.DEBUG)\n              u.publish(scrollToIndex, location)\n            } else {\n              log('list did not change, scroll successful', {}, LogLevel.DEBUG)\n            }\n          }\n\n          cleanup()\n\n          if (behavior === 'smooth') {\n            let listChanged = false\n            unsubscribeListRefresh = u.subscribe(listRefresh, (changed) => {\n              listChanged = listChanged || changed\n            })\n\n            unsubscribeNextListRefresh = u.handleNext(smoothScrollTargetReached, () => {\n              retry(listChanged)\n            })\n          } else {\n            unsubscribeNextListRefresh = u.handleNext(u.pipe(listRefresh, watchChangesFor(50)), retry)\n          }\n\n          // if the scroll jump is too small, the list won't get rerendered.\n          // clean this listener\n          cleartTimeoutRef = setTimeout(() => {\n            cleanup()\n          }, 1200)\n\n          u.publish(scrollingInProgress, true)\n          log('scrolling from index to', { index, top, behavior }, LogLevel.DEBUG)\n          return { top, behavior }\n        })\n      ),\n      scrollTo\n    )\n\n    return {\n      scrollToIndex,\n      topListHeight,\n    }\n  },\n  u.tup(sizeSystem, domIOSystem, loggerSystem),\n  { singleton: true }\n)\n\nfunction watchChangesFor(limit: number): u.Operator<boolean> {\n  return (done) => {\n    const timeoutRef = setTimeout(() => {\n      done(false)\n    }, limit)\n    return (value) => {\n      if (value) {\n        done(true)\n        clearTimeout(timeoutRef)\n      }\n    }\n  }\n}\n","import * as u from '@virtuoso.dev/urx'\nimport { domIOSystem } from './domIOSystem'\nimport { UP, DOWN, ScrollDirection } from './stateFlagsSystem'\nimport { tupleComparator } from './comparators'\n\nexport type NumberTuple = [number, number]\nexport type Overscan = number | { main: number; reverse: number }\nexport const TOP = 'top' as const\nexport const BOTTOM = 'bottom' as const\nexport const NONE = 'none' as const\nexport type ListEnd = typeof TOP | typeof BOTTOM\nexport type ViewportIncrease = number | { [k in ListEnd]?: number }\nexport type ChangeDirection = typeof UP | typeof DOWN | typeof NONE\n\nexport function getOverscan(overscan: Overscan, end: ListEnd, direction: ScrollDirection) {\n  if (typeof overscan === 'number') {\n    return (direction === UP && end === TOP) || (direction === DOWN && end === BOTTOM) ? overscan : 0\n  } else {\n    if (direction === UP) {\n      return end === TOP ? overscan.main : overscan.reverse\n    } else {\n      return end === BOTTOM ? overscan.main : overscan.reverse\n    }\n  }\n}\n\nfunction getViewportIncrease(value: ViewportIncrease, end: ListEnd) {\n  return typeof value === 'number' ? value : value[end] || 0\n}\n\nexport const sizeRangeSystem = u.system(\n  ([{ scrollTop, viewportHeight, deviation, headerHeight }]) => {\n    const listBoundary = u.stream<NumberTuple>()\n    const topListHeight = u.statefulStream(0)\n    const fixedHeaderHeight = u.statefulStream(0)\n    const increaseViewportBy = u.statefulStream<ViewportIncrease>(0)\n    const overscan = u.statefulStream<Overscan>(0)\n\n    const visibleRange = (u.statefulStreamFromEmitter(\n      u.pipe(\n        u.combineLatest(\n          u.duc(scrollTop),\n          u.duc(viewportHeight),\n          u.duc(headerHeight),\n          u.duc(overscan),\n          u.duc(fixedHeaderHeight),\n          u.duc(deviation),\n          u.duc(increaseViewportBy)\n        ),\n        u.map(([scrollTop, viewportHeight, headerHeight, overscan, fixedHeaderHeight, deviation, increaseViewportBy]) => {\n          const top = scrollTop - deviation\n          const headerVisible = Math.max(headerHeight - top, 0)\n          let direction: ChangeDirection = NONE\n          const topViewportAddition = getViewportIncrease(increaseViewportBy, TOP)\n          const bottomViewportAddition = getViewportIncrease(increaseViewportBy, BOTTOM)\n          return [\n            Math.max(top - headerHeight - getOverscan(overscan, TOP, direction) - topViewportAddition, 0),\n            top - headerVisible - fixedHeaderHeight + viewportHeight + getOverscan(overscan, BOTTOM, direction) + bottomViewportAddition,\n          ]\n        }),\n        u.distinctUntilChanged(tupleComparator as any)\n      ),\n      [0, 0]\n    ) as unknown) as u.StatefulStream<NumberTuple>\n\n    return {\n      // input\n      listBoundary,\n      overscan,\n      topListHeight,\n      fixedHeaderHeight,\n      increaseViewportBy,\n\n      // output\n      visibleRange,\n    }\n  },\n  u.tup(domIOSystem),\n  { singleton: true }\n)\n","import * as u from '@virtuoso.dev/urx'\nimport { domIOSystem } from './domIOSystem'\nimport { WindowViewportInfo } from './interfaces'\n\nexport const windowScrollerSystem = u.system(([{ scrollTo, scrollContainerState }]) => {\n  const windowScrollContainerState = u.stream<[number, number]>()\n  const windowViewportRect = u.stream<WindowViewportInfo>()\n  const windowScrollTo = u.stream<ScrollToOptions>()\n  const useWindowScroll = u.statefulStream(false)\n  const scrollElement = u.statefulStream<HTMLElement | undefined>(undefined)\n\n  u.connect(\n    u.pipe(\n      u.combineLatest(windowScrollContainerState, windowViewportRect),\n      u.map(([[windowScrollTop, scrollHeight], { offsetTop }]) => {\n        return [Math.max(0, windowScrollTop - offsetTop), scrollHeight]\n      })\n    ),\n    scrollContainerState\n  )\n\n  u.connect(\n    u.pipe(\n      scrollTo,\n      u.withLatestFrom(windowViewportRect),\n      u.map(([scrollTo, { offsetTop }]) => {\n        return {\n          ...scrollTo,\n          top: scrollTo.top! + offsetTop,\n        }\n      })\n    ),\n    windowScrollTo\n  )\n\n  return {\n    // config\n    useWindowScroll,\n    scrollElement,\n\n    // input\n    windowScrollContainerState,\n    windowViewportRect,\n\n    // signals\n    windowScrollTo,\n  }\n}, u.tup(domIOSystem))\n","import * as u from '@virtuoso.dev/urx'\nimport { rangeComparator, tupleComparator } from './comparators'\nimport { domIOSystem } from './domIOSystem'\nimport { propsReadySystem } from './propsReadySystem'\nimport { scrollSeekSystem } from './scrollSeekSystem'\nimport { IndexLocation, normalizeIndexLocation } from './scrollToIndexSystem'\nimport { sizeRangeSystem } from './sizeRangeSystem'\nimport { stateFlagsSystem } from './stateFlagsSystem'\nimport { windowScrollerSystem } from './windowScrollerSystem'\n\nexport interface ElementDimensions {\n  width: number\n  height: number\n}\n\nexport interface GridItem {\n  index: number\n}\n\nexport interface GridLayout {\n  top: number\n  bottom: number\n}\n\nexport interface GridState extends GridLayout {\n  items: GridItem[]\n  offsetTop: number\n  offsetBottom: number\n  itemHeight: number\n  itemWidth: number\n}\n\nconst INITIAL_GRID_STATE: GridState = {\n  items: [],\n  offsetBottom: 0,\n  offsetTop: 0,\n  top: 0,\n  bottom: 0,\n  itemHeight: 0,\n  itemWidth: 0,\n}\n\nconst PROBE_GRID_STATE: GridState = {\n  items: [{ index: 0 }],\n  offsetBottom: 0,\n  offsetTop: 0,\n  top: 0,\n  bottom: 0,\n  itemHeight: 0,\n  itemWidth: 0,\n}\n\nconst { ceil, floor, min, max } = Math\n\nfunction hackFloor(val: number) {\n  return ceil(val) - val < 0.03 ? ceil(val) : floor(val)\n}\n\nfunction buildItems(startIndex: number, endIndex: number) {\n  return Array.from({ length: endIndex - startIndex + 1 }).map((_, i) => ({ index: i + startIndex } as GridItem))\n}\nexport const gridSystem = u.system(\n  ([\n    { overscan, visibleRange, listBoundary },\n    { scrollTop, viewportHeight, scrollBy, scrollTo, smoothScrollTargetReached, scrollContainerState },\n    stateFlags,\n    scrollSeek,\n    { propsReady, didMount },\n    { windowViewportRect, windowScrollTo, useWindowScroll, scrollElement, windowScrollContainerState },\n  ]) => {\n    const totalCount = u.statefulStream(0)\n    const initialItemCount = u.statefulStream(0)\n    const gridState = u.statefulStream(INITIAL_GRID_STATE)\n    const viewportDimensions = u.statefulStream<ElementDimensions>({ height: 0, width: 0 })\n    const itemDimensions = u.statefulStream<ElementDimensions>({ height: 0, width: 0 })\n    const scrollToIndex = u.stream<IndexLocation>()\n    const scrollHeight = u.stream<number>()\n    const deviation = u.statefulStream(0)\n\n    u.connect(\n      u.pipe(\n        didMount,\n        u.withLatestFrom(initialItemCount),\n        u.filter(([, count]) => count !== 0),\n        u.map(([, count]) => {\n          return {\n            items: buildItems(0, count - 1),\n            top: 0,\n            bottom: 0,\n            offsetBottom: 0,\n            offsetTop: 0,\n            itemHeight: 0,\n            itemWidth: 0,\n          }\n        })\n      ),\n      gridState\n    )\n\n    u.connect(\n      u.pipe(\n        u.combineLatest(\n          u.duc(totalCount),\n          visibleRange,\n          u.duc(itemDimensions, (prev, next) => prev && prev.width === next.width && prev.height === next.height)\n        ),\n        u.withLatestFrom(viewportDimensions),\n        u.map(([[totalCount, [startOffset, endOffset], item], viewport]) => {\n          const { height: itemHeight, width: itemWidth } = item\n          const { width: viewportWidth } = viewport\n\n          if (totalCount === 0 || viewportWidth === 0) {\n            return INITIAL_GRID_STATE\n          }\n\n          if (itemWidth === 0) {\n            return PROBE_GRID_STATE\n          }\n\n          const perRow = hackFloor(viewportWidth / itemWidth)\n          let startIndex = perRow * floor(startOffset / itemHeight)\n          let endIndex = perRow * ceil(endOffset / itemHeight) - 1\n          endIndex = min(totalCount - 1, endIndex)\n          startIndex = min(endIndex, max(0, startIndex))\n\n          const items = buildItems(startIndex, endIndex)\n          const { top, bottom } = gridLayout(viewport, item, items)\n          const totalHeight = ceil(totalCount / perRow) * itemHeight\n          const offsetBottom = totalHeight - bottom\n\n          return { items, offsetTop: top, offsetBottom, top, bottom, itemHeight, itemWidth } as GridState\n        })\n      ),\n      gridState\n    )\n\n    u.connect(\n      u.pipe(\n        viewportDimensions,\n        u.map(({ height }) => height)\n      ),\n      viewportHeight\n    )\n\n    u.connect(\n      u.pipe(\n        u.combineLatest(viewportDimensions, itemDimensions, gridState),\n        u.map(([viewportDimensions, item, { items }]) => {\n          const { top, bottom } = gridLayout(viewportDimensions, item, items)\n\n          return [top, bottom] as [number, number]\n        }),\n        u.distinctUntilChanged(tupleComparator)\n      ),\n      listBoundary\n    )\n\n    const endReached = u.streamFromEmitter(\n      u.pipe(\n        u.duc(gridState),\n        u.filter(({ items }) => items.length > 0),\n        u.withLatestFrom(totalCount),\n        u.filter(([{ items }, totalCount]) => items[items.length - 1].index === totalCount - 1),\n        u.map(([, totalCount]) => totalCount - 1),\n        u.distinctUntilChanged()\n      )\n    )\n\n    const startReached = u.streamFromEmitter(\n      u.pipe(\n        u.duc(gridState),\n        u.filter(({ items }) => {\n          return items.length > 0 && items[0].index === 0\n        }),\n        u.mapTo(0),\n        u.distinctUntilChanged()\n      )\n    )\n\n    const rangeChanged = u.streamFromEmitter(\n      u.pipe(\n        u.duc(gridState),\n        u.filter(({ items }) => items.length > 0),\n        u.map(({ items }) => {\n          return {\n            startIndex: items[0].index,\n            endIndex: items[items.length - 1].index,\n          }\n        }),\n        u.distinctUntilChanged(rangeComparator)\n      )\n    )\n\n    u.connect(rangeChanged, scrollSeek.scrollSeekRangeChanged)\n\n    u.connect(\n      u.pipe(\n        scrollToIndex,\n        u.withLatestFrom(viewportDimensions, itemDimensions, totalCount),\n        u.map(([location, viewport, item, totalCount]) => {\n          const normalLocation = normalizeIndexLocation(location)\n          const { align, behavior, offset } = normalLocation\n          let index = normalLocation.index\n          if (index === 'LAST') {\n            index = totalCount - 1\n          }\n\n          index = Math.max(0, index, Math.min(totalCount - 1, index))\n\n          let top = itemTop(viewport, item, index)\n\n          if (align === 'end') {\n            top = Math.round(top - viewport.height + item.height)\n          } else if (align === 'center') {\n            top = Math.round(top - viewport.height / 2 + item.height / 2)\n          }\n\n          if (offset) {\n            top += offset\n          }\n\n          return { top, behavior }\n        })\n      ),\n      scrollTo\n    )\n\n    const totalListHeight = u.statefulStreamFromEmitter(\n      u.pipe(\n        gridState,\n        u.map((gridState) => {\n          return gridState.offsetBottom + gridState.bottom\n        })\n      ),\n      0\n    )\n\n    u.connect(\n      u.pipe(\n        windowViewportRect,\n        u.map((viewportInfo) => ({ width: viewportInfo.visibleWidth, height: viewportInfo.visibleHeight }))\n      ),\n      viewportDimensions\n    )\n\n    return {\n      // input\n      totalCount,\n      viewportDimensions,\n      itemDimensions,\n      scrollTop,\n      scrollHeight,\n      overscan,\n      scrollBy,\n      scrollTo,\n      scrollToIndex,\n      smoothScrollTargetReached,\n      windowViewportRect,\n      windowScrollTo,\n      useWindowScroll,\n      scrollElement,\n      windowScrollContainerState,\n      deviation,\n      scrollContainerState,\n      initialItemCount,\n      ...scrollSeek,\n\n      // output\n      gridState,\n      totalListHeight,\n      ...stateFlags,\n      startReached,\n      endReached,\n      rangeChanged,\n      propsReady,\n    }\n  },\n  u.tup(sizeRangeSystem, domIOSystem, stateFlagsSystem, scrollSeekSystem, propsReadySystem, windowScrollerSystem)\n)\n\nfunction gridLayout(viewport: ElementDimensions, item: ElementDimensions, items: GridItem[]): GridLayout {\n  const { height: itemHeight } = item\n  if (itemHeight === undefined || items.length === 0) {\n    return { top: 0, bottom: 0 }\n  }\n\n  const top = itemTop(viewport, item, items[0].index)\n  const bottom = itemTop(viewport, item, items[items.length - 1].index) + itemHeight\n  return { top, bottom }\n}\n\nfunction itemTop(viewport: ElementDimensions, item: ElementDimensions, index: number) {\n  const perRow = itemsPerRow(viewport.width, item.width)\n  return floor(index / perRow) * item.height\n}\n\nfunction itemsPerRow(viewportWidth: number, itemWidth: number) {\n  return hackFloor(viewportWidth / itemWidth)\n}\n","import { useRef } from 'react'\n\nexport type CallbackRefParam = HTMLElement | null\n\nexport function useSizeWithElRef(callback: (e: HTMLElement) => void, enabled = true) {\n  const ref = useRef<CallbackRefParam>(null)\n\n  let callbackRef = (_el: CallbackRefParam) => {\n    void 0\n  }\n\n  if (typeof ResizeObserver !== 'undefined') {\n    const observer = new ResizeObserver((entries: ResizeObserverEntry[]) => {\n      const element = entries[0].target as HTMLElement\n      // Revert the RAF below - it causes a blink in the upward scrolling fix\n      // See e2e/chat example\n      // Avoid Resize loop limit exceeded error\n      // https://github.com/edunad/react-virtuoso/commit/581d4558f2994adea375291b76fe59605556c08f\n      // requestAnimationFrame(() => {\n      //\n      // if display: none, the element won't have an offsetParent\n      // measuring it at this mode is not going to work\n      // https://stackoverflow.com/a/21696585/1009797\n      if (element.offsetParent !== null) {\n        callback(element)\n      }\n      // })\n    })\n\n    callbackRef = (elRef: CallbackRefParam) => {\n      if (elRef && enabled) {\n        observer.observe(elRef)\n        ref.current = elRef\n      } else {\n        if (ref.current) {\n          observer.unobserve(ref.current)\n        }\n        ref.current = null\n      }\n    }\n  }\n\n  return { ref, callbackRef }\n}\n\nexport default function useSize(callback: (e: HTMLElement) => void, enabled = true) {\n  return useSizeWithElRef(callback, enabled).callbackRef\n}\n","import { useEffect, useRef, useCallback } from 'react'\nimport { useSizeWithElRef } from './useSize'\nimport { WindowViewportInfo } from '../interfaces'\nimport useResizeObserver from './useResizeObserver'\n\nconst getScrollElementInfo = (element: HTMLElement, scrollElement: HTMLElement) => {\n  const rect = element.getBoundingClientRect()\n  const seRect = scrollElement.getBoundingClientRect()\n  const deltaTop = rect.top - seRect.top\n  return {\n    offsetTop: deltaTop + scrollElement.scrollTop,\n    visibleHeight: Math.max(0, seRect.height - Math.max(0, deltaTop)),\n    visibleWidth: rect.width,\n  }\n}\n\nexport default function useWindowViewportRectRef(callback: (info: WindowViewportInfo) => void, scrollElement?: HTMLElement) {\n  const viewportInfo = useRef<WindowViewportInfo | null>(null)\n\n  const calculateInfo = useCallback(\n    (element: HTMLElement | null) => {\n      if (element === null) {\n        return\n      }\n      const rect = element.getBoundingClientRect()\n      const visibleHeight = Math.max(0, window.innerHeight - Math.max(0, rect.top))\n\n      const visibleWidth = rect.width\n      const offsetTop = rect.top + window.pageYOffset\n      viewportInfo.current = scrollElement\n        ? getScrollElementInfo(element, scrollElement)\n        : {\n            offsetTop,\n            visibleHeight,\n            visibleWidth,\n          }\n      callback(viewportInfo.current)\n    },\n    [callback, scrollElement]\n  )\n\n  const { callbackRef, ref } = useSizeWithElRef(calculateInfo)\n\n  const windowEH = useCallback(() => {\n    calculateInfo(ref.current)\n  }, [calculateInfo, ref])\n\n  useResizeObserver(scrollElement, windowEH) // resize events do not trigger on elements so use an observer\n  useEffect(() => {\n    const element = scrollElement ? scrollElement : window\n\n    element?.addEventListener('scroll', windowEH)\n    !scrollElement && window.addEventListener('resize', windowEH)\n    return () => {\n      element?.removeEventListener('scroll', windowEH)\n      !scrollElement && window.removeEventListener('resize', windowEH)\n    }\n  }, [windowEH, scrollElement])\n\n  return callbackRef\n}\n","import { useEffect, useLayoutEffect } from 'react'\n\nconst useIsomorphicLayoutEffect = typeof document !== 'undefined' ? useLayoutEffect : useEffect\n\nexport default useIsomorphicLayoutEffect\n","import { Log, LogLevel } from '../loggerSystem'\nimport { SizeFunction, SizeRange } from '../sizeSystem'\nimport useSize from './useSize'\n\nexport default function useChangedListContentsSizes(\n  callback: (ranges: SizeRange[]) => void,\n  itemSize: SizeFunction,\n  enabled: boolean,\n  scrollContainerStateCallback: (state: [number, number]) => void,\n  log: Log,\n  scrollElement?: HTMLElement\n) {\n  return useSize((el: HTMLElement) => {\n    const ranges = getChangedChildSizes(el.children, itemSize, 'offsetHeight', log)\n    let scrollableElement = el.parentElement!\n\n    while (!scrollableElement.dataset['virtuosoScroller']) {\n      scrollableElement = scrollableElement.parentElement!\n    }\n\n    const scrollTop = scrollElement\n      ? scrollElement.scrollTop\n      : // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      (scrollableElement.firstElementChild! as HTMLDivElement).dataset['viewportType']! === 'window'\n      ? window.pageYOffset || document.documentElement.scrollTop\n      : scrollableElement.scrollTop\n\n    scrollElement\n      ? scrollContainerStateCallback([Math.max(scrollTop, 0), scrollElement.scrollHeight])\n      : scrollContainerStateCallback([Math.max(scrollTop, 0), scrollableElement.scrollHeight])\n    if (ranges !== null) {\n      callback(ranges)\n    }\n  }, enabled)\n}\n\nfunction getChangedChildSizes(children: HTMLCollection, itemSize: SizeFunction, field: 'offsetHeight' | 'offsetWidth', log: Log) {\n  const length = children.length\n\n  if (length === 0) {\n    return null\n  }\n\n  const results: SizeRange[] = []\n\n  for (let i = 0; i < length; i++) {\n    const child = children.item(i) as HTMLElement\n\n    if (!child || child.dataset.index === undefined) {\n      continue\n    }\n\n    const index = parseInt(child.dataset.index!)\n    const knownSize = parseFloat(child.dataset.knownSize!)\n    const size = itemSize(child, field)\n\n    if (size === 0) {\n      log('Zero-sized element, this should not happen', { child }, LogLevel.ERROR)\n    }\n\n    if (size === knownSize) {\n      continue\n    }\n\n    const lastResult = results[results.length - 1]\n    if (results.length === 0 || lastResult.size !== size || lastResult.endIndex !== index - 1) {\n      results.push({ startIndex: index, endIndex: index, size })\n    } else {\n      results[results.length - 1].endIndex++\n    }\n  }\n\n  return results\n}\n","import { useRef, useCallback, useEffect } from 'react'\nimport * as u from '@virtuoso.dev/urx'\nimport { correctItemSize } from '../utils/correctItemSize'\n\nexport type ScrollerRef = Window | HTMLElement | null\n\nfunction approximatelyEqual(num1: number, num2: number) {\n  return Math.abs(num1 - num2) < 1.01\n}\n\nexport default function useScrollTop(\n  scrollContainerStateCallback: (state: [number, number]) => void,\n  smoothScrollTargetReached: (yes: true) => void,\n  scrollerElement: any,\n  scrollerRefCallback: (ref: ScrollerRef) => void = u.noop,\n  scrollElement?: HTMLElement\n) {\n  const scrollerRef = useRef<HTMLElement | null | Window>(null)\n  const scrollTopTarget = useRef<any>(null)\n  const timeoutRef = useRef<any>(null)\n\n  const handler = useCallback(\n    (ev: Event) => {\n      const el = ev.target as HTMLElement\n      const scrollTop =\n        (el as any) === window || (el as any) === document ? window.pageYOffset || document.documentElement.scrollTop : el.scrollTop\n      const scrollHeight = (el as any) === window ? document.documentElement.scrollHeight : el.scrollHeight\n\n      scrollContainerStateCallback([Math.max(scrollTop, 0), scrollHeight])\n\n      if (scrollTopTarget.current !== null) {\n        if (scrollTop === scrollTopTarget.current || scrollTop <= 0 || scrollTop === el.scrollHeight - correctItemSize(el, 'height')) {\n          scrollTopTarget.current = null\n          smoothScrollTargetReached(true)\n          if (timeoutRef.current) {\n            clearTimeout(timeoutRef.current)\n            timeoutRef.current = null\n          }\n        }\n      }\n    },\n    [scrollContainerStateCallback, smoothScrollTargetReached]\n  )\n\n  useEffect(() => {\n    const localRef = scrollElement ? scrollElement : scrollerRef.current!\n\n    scrollerRefCallback(scrollElement ? scrollElement : scrollerRef.current)\n    handler(({ target: localRef } as unknown) as Event)\n    localRef.addEventListener('scroll', handler, { passive: true })\n\n    return () => {\n      scrollerRefCallback(null)\n      localRef.removeEventListener('scroll', handler)\n    }\n  }, [scrollerRef, handler, scrollerElement, scrollerRefCallback, scrollElement])\n\n  function scrollToCallback(location: ScrollToOptions) {\n    const scrollerElement = scrollerRef.current\n    if (!scrollerElement || ('offsetHeight' in scrollerElement && scrollerElement.offsetHeight === 0)) {\n      return\n    }\n\n    const isSmooth = location.behavior === 'smooth'\n\n    let offsetHeight: number\n    let scrollHeight: number\n    let scrollTop: number\n\n    if (scrollerElement === window) {\n      // this is not a mistake\n      scrollHeight = Math.max(correctItemSize(document.documentElement, 'height'), document.documentElement.scrollHeight)\n      offsetHeight = window.innerHeight\n      scrollTop = document.documentElement.scrollTop\n    } else {\n      scrollHeight = (scrollerElement as HTMLElement).scrollHeight\n      offsetHeight = correctItemSize(scrollerElement as HTMLElement, 'height')\n      scrollTop = (scrollerElement as HTMLElement).scrollTop\n    }\n\n    const maxScrollTop = scrollHeight - offsetHeight\n    location.top = Math.ceil(Math.max(Math.min(maxScrollTop, location.top!), 0))\n\n    // avoid system hanging because the DOM never called back\n    // with the scrollTop\n    // scroller is already at this location\n    if (approximatelyEqual(offsetHeight, scrollHeight) || location.top === scrollTop) {\n      scrollContainerStateCallback([scrollTop, scrollHeight])\n      if (isSmooth) {\n        smoothScrollTargetReached(true)\n      }\n      return\n    }\n\n    if (isSmooth) {\n      scrollTopTarget.current = location.top\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current)\n      }\n\n      timeoutRef.current = setTimeout(() => {\n        timeoutRef.current = null\n        scrollTopTarget.current = null\n        smoothScrollTargetReached(true)\n      }, 1000)\n    } else {\n      scrollTopTarget.current = null\n    }\n\n    scrollerElement.scrollTo(location)\n  }\n\n  function scrollByCallback(location: ScrollToOptions) {\n    if (scrollTopTarget.current === null) {\n      scrollerRef.current!.scrollBy(location)\n    }\n  }\n\n  return { scrollerRef, scrollByCallback, scrollToCallback }\n}\n","import * as u from '@virtuoso.dev/urx'\nimport { empty } from './AATree'\nimport { sizeSystem } from './sizeSystem'\nimport { domIOSystem } from './domIOSystem'\nimport { scrollToIndexSystem } from './scrollToIndexSystem'\nimport { propsReadySystem } from './propsReadySystem'\n\nexport const initialTopMostItemIndexSystem = u.system(\n  ([{ sizes, listRefresh, defaultItemSize }, { scrollTop }, { scrollToIndex }, { didMount }]) => {\n    const scrolledToInitialItem = u.statefulStream(true)\n    const initialTopMostItemIndex = u.statefulStream(0)\n\n    u.connect(\n      u.pipe(\n        didMount,\n        u.withLatestFrom(initialTopMostItemIndex),\n        u.filter(([_, index]) => index !== 0),\n        u.mapTo(false)\n      ),\n      scrolledToInitialItem\n    )\n\n    u.subscribe(\n      u.pipe(\n        u.combineLatest(listRefresh, didMount),\n        u.withLatestFrom(scrolledToInitialItem, sizes, defaultItemSize),\n        u.filter(([[, didMount], scrolledToInitialItem, { sizeTree }, defaultItemSize]) => {\n          return didMount && (!empty(sizeTree) || defaultItemSize !== undefined) && !scrolledToInitialItem\n        }),\n        u.withLatestFrom(initialTopMostItemIndex)\n      ),\n      ([, initialTopMostItemIndex]) => {\n        setTimeout(() => {\n          u.handleNext(scrollTop, () => {\n            u.publish(scrolledToInitialItem, true)\n          })\n          u.publish(scrollToIndex, initialTopMostItemIndex)\n        })\n      }\n    )\n\n    return {\n      scrolledToInitialItem,\n      initialTopMostItemIndex,\n    }\n  },\n  u.tup(sizeSystem, domIOSystem, scrollToIndexSystem, propsReadySystem),\n  { singleton: true }\n)\n","/* eslint-disable @typescript-eslint/no-unsafe-call */\nimport * as u from '@virtuoso.dev/urx'\nimport { scrollToIndexSystem } from './scrollToIndexSystem'\nimport { sizeSystem } from './sizeSystem'\nimport { stateFlagsSystem } from './stateFlagsSystem'\nimport { initialTopMostItemIndexSystem } from './initialTopMostItemIndexSystem'\nimport { FollowOutput, FollowOutputScalarType } from './interfaces'\nimport { propsReadySystem } from './propsReadySystem'\nimport { loggerSystem, LogLevel } from './loggerSystem'\nimport { domIOSystem } from './domIOSystem'\n\nfunction normalizeFollowOutput(follow: FollowOutputScalarType): FollowOutputScalarType {\n  if (!follow) {\n    return false\n  }\n  return follow === 'smooth' ? 'smooth' : 'auto'\n}\n\nconst behaviorFromFollowOutput = (follow: FollowOutput, isAtBottom: boolean) => {\n  if (typeof follow === 'function') {\n    return normalizeFollowOutput(follow(isAtBottom))\n  }\n  return isAtBottom && normalizeFollowOutput(follow)\n}\n\nexport const followOutputSystem = u.system(\n  ([\n    { totalCount, listRefresh },\n    { isAtBottom, atBottomState },\n    { scrollToIndex },\n    { scrolledToInitialItem },\n    { propsReady, didMount },\n    { log },\n    { scrollingInProgress },\n  ]) => {\n    const followOutput = u.statefulStream<FollowOutput>(false)\n    let pendingScrollHandle: any = null\n\n    function scrollToBottom(followOutputBehavior: FollowOutputScalarType) {\n      u.publish(scrollToIndex, {\n        index: 'LAST',\n        align: 'end',\n        behavior: followOutputBehavior,\n      })\n    }\n\n    u.subscribe(\n      u.pipe(\n        u.combineLatest(u.pipe(u.duc(totalCount), u.skip(1)), didMount),\n        u.withLatestFrom(u.duc(followOutput), isAtBottom, scrolledToInitialItem, scrollingInProgress),\n        u.map(([[totalCount, didMount], followOutput, isAtBottom, scrolledToInitialItem, scrollingInProgress]) => {\n          let shouldFollow = didMount && scrolledToInitialItem\n          let followOutputBehavior: FollowOutputScalarType = 'auto'\n\n          if (shouldFollow) {\n            // if scrolling to index is in progress,\n            // assume that a previous followOutput response is going\n            followOutputBehavior = behaviorFromFollowOutput(followOutput, isAtBottom || scrollingInProgress) as any\n            shouldFollow = shouldFollow && !!followOutputBehavior\n          }\n\n          return { totalCount, shouldFollow, followOutputBehavior }\n        }),\n        u.filter(({ shouldFollow }) => shouldFollow)\n      ),\n      ({ totalCount, followOutputBehavior }) => {\n        if (pendingScrollHandle) {\n          pendingScrollHandle()\n          pendingScrollHandle = null\n        }\n\n        pendingScrollHandle = u.handleNext(listRefresh, () => {\n          u.getValue(log)('following output to ', { totalCount }, LogLevel.DEBUG)\n          scrollToBottom(followOutputBehavior)\n          pendingScrollHandle = null\n        })\n      }\n    )\n\n    u.subscribe(\n      u.pipe(\n        u.combineLatest(u.duc(followOutput), totalCount, propsReady),\n        u.filter(([follow, , ready]) => follow && ready),\n        u.scan(\n          ({ value }, [, next]) => {\n            return { refreshed: value === next, value: next }\n          },\n          { refreshed: false, value: 0 }\n        ),\n        u.filter(({ refreshed }) => refreshed),\n        u.withLatestFrom(followOutput, totalCount)\n      ),\n      ([, followOutput]) => {\n        const cancel = u.handleNext(atBottomState, (state: any) => {\n          if (followOutput && !state.atBottom && state.notAtBottomBecause === 'SIZE_INCREASED' && !pendingScrollHandle) {\n            u.getValue(log)('scrolling to bottom due to increased size', {}, LogLevel.DEBUG)\n            scrollToBottom('auto')\n          }\n        })\n        setTimeout(cancel, 100)\n      }\n    )\n\n    u.subscribe(u.combineLatest(u.duc(followOutput), atBottomState), ([followOutput, state]: any) => {\n      if (followOutput && !state.atBottom && state.notAtBottomBecause === 'VIEWPORT_HEIGHT_DECREASING') {\n        scrollToBottom('auto')\n      }\n    })\n\n    return { followOutput }\n  },\n  u.tup(sizeSystem, stateFlagsSystem, scrollToIndexSystem, initialTopMostItemIndexSystem, propsReadySystem, loggerSystem, domIOSystem)\n)\n","import {\n  combineLatest,\n  connect,\n  distinctUntilChanged,\n  system,\n  filter,\n  map,\n  pipe,\n  prop,\n  stream,\n  streamFromEmitter,\n  tup,\n} from '@virtuoso.dev/urx'\nimport { findMaxKeyValue } from './AATree'\nimport { domIOSystem } from './domIOSystem'\nimport { sizeSystem, hasGroups } from './sizeSystem'\nexport interface GroupIndexesAndCount {\n  totalCount: number\n  groupIndices: number[]\n}\n\nexport function groupCountsToIndicesAndCount(counts: number[]) {\n  return counts.reduce(\n    (acc, groupCount) => {\n      acc.groupIndices.push(acc.totalCount)\n      acc.totalCount += groupCount + 1\n      return acc\n    },\n    {\n      totalCount: 0,\n      groupIndices: [],\n    } as GroupIndexesAndCount\n  )\n}\n\nexport const groupedListSystem = system(([{ totalCount, groupIndices, sizes }, { scrollTop, headerHeight }]) => {\n  const groupCounts = stream<number[]>()\n  const topItemsIndexes = stream<[number]>()\n  const groupIndicesAndCount = streamFromEmitter(pipe(groupCounts, map(groupCountsToIndicesAndCount)))\n  connect(pipe(groupIndicesAndCount, map(prop('totalCount'))), totalCount)\n  connect(pipe(groupIndicesAndCount, map(prop('groupIndices'))), groupIndices)\n\n  connect(\n    pipe(\n      combineLatest(scrollTop, sizes, headerHeight),\n      filter(([_, sizes]) => hasGroups(sizes)),\n      map(([scrollTop, state, headerHeight]) => findMaxKeyValue(state.groupOffsetTree, Math.max(scrollTop - headerHeight, 0), 'v')[0]),\n      distinctUntilChanged(),\n      map((index) => [index])\n    ),\n    topItemsIndexes\n  )\n\n  return { groupCounts, topItemsIndexes }\n}, tup(sizeSystem, domIOSystem))\n","import * as u from '@virtuoso.dev/urx';\nimport { empty, findMaxKeyValue, Range, rangesWithin } from './AATree';\nimport { groupedListSystem } from './groupedListSystem';\nimport { initialTopMostItemIndexSystem } from './initialTopMostItemIndexSystem';\nimport { Item, ListItem, ListRange } from './interfaces';\nimport { propsReadySystem } from './propsReadySystem';\nimport { scrollToIndexSystem } from './scrollToIndexSystem';\nimport { sizeRangeSystem } from './sizeRangeSystem';\nimport { Data, originalIndexFromItemIndex, SizeState, sizeSystem, hasGroups, rangesWithinOffsets } from './sizeSystem';\nimport { stateFlagsSystem } from './stateFlagsSystem';\nimport { rangeComparator, tupleComparator } from './comparators';\n\nexport type ListItems = ListItem<unknown>[];\nexport interface TopListState {\n  items: ListItems;\n  listHeight: number;\n}\n\nexport interface ListState {\n  items: ListItems;\n  topItems: ListItems;\n  topListHeight: number;\n  offsetTop: number;\n  offsetBottom: number;\n  top: number;\n  bottom: number;\n  totalCount: number;\n}\n\nfunction probeItemSet(index: number, sizes: SizeState, data: Data) {\n  if (hasGroups(sizes)) {\n    const itemIndex = originalIndexFromItemIndex(index, sizes);\n    const groupIndex = findMaxKeyValue(sizes.groupOffsetTree, itemIndex)[0];\n\n    return [\n      { index: groupIndex, size: 0, offset: 0 },\n      { index: itemIndex, size: 0, offset: 0, data: data && data[0] }\n    ];\n  }\n  return [{ index, size: 0, offset: 0, data: data && data[0] }];\n}\n\nconst EMPTY_LIST_STATE: ListState = {\n  items: [] as ListItems,\n  topItems: [] as ListItems,\n  offsetTop: 0,\n  offsetBottom: 0,\n  top: 0,\n  bottom: 0,\n  topListHeight: 0,\n  totalCount: 0\n};\n\nfunction transposeItems(items: Item<any>[], sizes: SizeState, firstItemIndex: number): ListItems {\n  if (items.length === 0) {\n    return [];\n  }\n\n  if (!hasGroups(sizes)) {\n    return items.map(item => ({ ...item, index: item.index + firstItemIndex, originalIndex: item.index }));\n  }\n\n  const startIndex = items[0].index;\n  const endIndex = items[items.length - 1].index;\n\n  const transposedItems = [] as ListItems;\n  const groupRanges = rangesWithin(sizes.groupOffsetTree, startIndex, endIndex);\n  let currentRange: Range<number> | undefined = undefined;\n  let currentGroupIndex = 0;\n\n  for (const item of items) {\n    if (!currentRange || currentRange.end < item.index) {\n      currentRange = groupRanges.shift()!;\n      currentGroupIndex = sizes.groupIndices.indexOf(currentRange.start);\n    }\n\n    let transposedItem: { type: 'group'; index: number } | { index: number; groupIndex: number };\n\n    if (item.index === currentRange.start) {\n      transposedItem = {\n        type: 'group' as const,\n        index: currentGroupIndex\n      };\n    } else {\n      transposedItem = {\n        index: item.index - (currentGroupIndex + 1) + firstItemIndex,\n        groupIndex: currentGroupIndex\n      };\n    }\n\n    transposedItems.push({\n      ...transposedItem,\n      size: item.size,\n      offset: item.offset,\n      originalIndex: item.index,\n      data: item.data\n    });\n  }\n\n  return transposedItems;\n}\n\nexport function buildListState(items: Item<any>[], topItems: Item<any>[], totalCount: number, sizes: SizeState, firstItemIndex: number): ListState {\n  const { lastSize, lastOffset, lastIndex } = sizes;\n  let offsetTop = 0;\n  let bottom = 0;\n\n  if (items.length > 0) {\n    offsetTop = items[0].offset;\n    const lastItem = items[items.length - 1];\n    bottom = lastItem.offset + lastItem.size;\n  }\n\n  const total = lastOffset + (totalCount - lastIndex) * lastSize;\n  const top = offsetTop;\n  const offsetBottom = total - bottom;\n\n  return {\n    items: transposeItems(items, sizes, firstItemIndex),\n    topItems: transposeItems(topItems, sizes, firstItemIndex),\n    topListHeight: topItems.reduce((height, item) => item.size + height, 0),\n    offsetTop,\n    offsetBottom,\n    top,\n    bottom,\n    totalCount\n  };\n}\n\nexport const listStateSystem = u.system(\n  ([\n    { sizes, totalCount, data, firstItemIndex },\n    groupedListSystem,\n    { visibleRange, listBoundary, topListHeight: rangeTopListHeight },\n    { scrolledToInitialItem, initialTopMostItemIndex },\n    { topListHeight },\n    stateFlags,\n    { didMount }\n  ]) => {\n    const topItemsIndexes = u.statefulStream<Array<number>>([]);\n    const itemsRendered = u.stream<ListItems>();\n\n    u.connect(groupedListSystem.topItemsIndexes, topItemsIndexes);\n\n    const listState = u.statefulStreamFromEmitter(\n      u.pipe(\n        u.combineLatest(\n          didMount,\n          u.duc(visibleRange),\n          u.duc(totalCount),\n          u.duc(sizes),\n          u.duc(initialTopMostItemIndex),\n          scrolledToInitialItem,\n          u.duc(topItemsIndexes),\n          u.duc(firstItemIndex),\n          data\n        ),\n        u.filter(([mount]) => mount),\n        u.map(([, [startOffset, endOffset], totalCount, sizes, initialTopMostItemIndex, scrolledToInitialItem, topItemsIndexes, firstItemIndex, data]) => {\n          const sizesValue = sizes;\n          const { sizeTree, offsetTree } = sizesValue;\n\n          if (totalCount === 0 || (startOffset === 0 && endOffset === 0)) {\n            return EMPTY_LIST_STATE;\n          }\n\n          if (empty(sizeTree)) {\n            return buildListState(probeItemSet(initialTopMostItemIndex, sizesValue, data), [], totalCount, sizesValue, firstItemIndex);\n          }\n\n          const topItems = [] as Item<any>[];\n\n          if (topItemsIndexes.length > 0) {\n            const startIndex = topItemsIndexes[0];\n            const endIndex = topItemsIndexes[topItemsIndexes.length - 1];\n            let offset = 0;\n            for (const range of rangesWithin(sizeTree, startIndex, endIndex)) {\n              const size = range.value;\n              const rangeStartIndex = Math.max(range.start, startIndex);\n              const rangeEndIndex = Math.min(range.end, endIndex);\n              for (let i = rangeStartIndex; i <= rangeEndIndex; i++) {\n                topItems.push({ index: i, size, offset: offset, data: data && data[i] });\n                offset += size;\n              }\n            }\n          }\n\n          // If the list hasn't scrolled to the initial item because the initial item was set,\n          // render empty list.\n          //\n          // This is a condition to be evaluated past the probe check, do not merge\n          // with the totalCount check above\n          if (!scrolledToInitialItem) {\n            return buildListState([], topItems, totalCount, sizesValue, firstItemIndex);\n          }\n\n          const minStartIndex = topItemsIndexes.length > 0 ? topItemsIndexes[topItemsIndexes.length - 1] + 1 : 0;\n\n          const offsetPointRanges = rangesWithinOffsets(offsetTree, startOffset, endOffset, minStartIndex);\n          if (offsetPointRanges.length === 0) {\n            return null;\n          }\n\n          const maxIndex = totalCount - 1;\n\n          const items = u.tap([] as Item<any>[], result => {\n            for (const range of offsetPointRanges) {\n              const point = range.value;\n              let offset = point.offset;\n              let rangeStartIndex = range.start;\n              const size = point.size;\n\n              if (point.offset < startOffset) {\n                rangeStartIndex += Math.floor((startOffset - point.offset) / size);\n                offset += (rangeStartIndex - range.start) * size;\n              }\n\n              if (rangeStartIndex < minStartIndex) {\n                offset += (minStartIndex - rangeStartIndex) * size;\n                rangeStartIndex = minStartIndex;\n              }\n\n              const endIndex = Math.min(range.end, maxIndex);\n\n              for (let i = rangeStartIndex; i <= endIndex; i++) {\n                if (offset >= endOffset) {\n                  break;\n                }\n\n                result.push({ index: i, size, offset: offset, data: data && data[i] });\n                offset += size;\n              }\n            }\n          });\n\n          return buildListState(items, topItems, totalCount, sizesValue, firstItemIndex);\n        }),\n        u.filter(value => value !== null),\n        u.distinctUntilChanged()\n      ),\n      EMPTY_LIST_STATE\n    );\n\n    u.connect(\n      u.pipe(\n        data,\n        u.filter(data => data !== undefined),\n        u.map(data => data!.length)\n      ),\n      totalCount\n    );\n\n    u.connect(u.pipe(listState, u.map(u.prop('topListHeight'))), topListHeight);\n    u.connect(topListHeight, rangeTopListHeight);\n\n    u.connect(\n      u.pipe(\n        listState,\n        u.map(state => [state.top, state.bottom])\n      ),\n      listBoundary\n    );\n\n    u.connect(\n      u.pipe(\n        listState,\n        u.map(state => state.items)\n      ),\n      itemsRendered\n    );\n\n    const endReached = u.streamFromEmitter(\n      u.pipe(\n        listState,\n        u.filter(({ items }) => items.length > 0),\n        u.withLatestFrom(totalCount, data),\n        u.filter(([{ items }, totalCount]) => items[items.length - 1].originalIndex === totalCount - 1),\n        u.map(([, totalCount, data]) => [totalCount - 1, data] as [number, unknown[]]),\n        u.distinctUntilChanged(tupleComparator),\n        u.map(([count]) => count as number)\n      )\n    );\n\n    const startReached = u.streamFromEmitter(\n      u.pipe(\n        listState,\n        u.throttleTime(200),\n        u.filter(({ items, topItems }) => {\n          return items.length > 0 && items[0].originalIndex === topItems.length;\n        }),\n        u.map(({ items }) => items[0].index),\n        u.distinctUntilChanged()\n      )\n    );\n\n    const rangeChanged = u.streamFromEmitter(\n      u.pipe(\n        listState,\n        u.filter(({ items }) => items.length > 0),\n        u.map(({ items }) => {\n          return {\n            startIndex: items[0].index,\n            endIndex: items[items.length - 1].index\n          } as ListRange;\n        }),\n        u.distinctUntilChanged(rangeComparator)\n      )\n    );\n\n    return { listState, topItemsIndexes, endReached, startReached, rangeChanged, itemsRendered, ...stateFlags };\n  },\n  u.tup(sizeSystem, groupedListSystem, sizeRangeSystem, initialTopMostItemIndexSystem, scrollToIndexSystem, stateFlagsSystem, propsReadySystem),\n  { singleton: true }\n);\n","import * as u from '@virtuoso.dev/urx'\nimport { listStateSystem, buildListState } from './listStateSystem'\nimport { sizeSystem } from './sizeSystem'\nimport { propsReadySystem } from './propsReadySystem'\n\nexport const initialItemCountSystem = u.system(\n  ([{ sizes, firstItemIndex, data }, { listState }, { didMount }]) => {\n    const initialItemCount = u.statefulStream(0)\n\n    u.connect(\n      u.pipe(\n        didMount,\n        u.withLatestFrom(initialItemCount),\n        u.filter(([, count]) => count !== 0),\n        u.withLatestFrom(sizes, firstItemIndex, data),\n        u.map(([[, count], sizes, firstItemIndex, data = []]) => {\n          let includedGroupsCount = 0\n          if (sizes.groupIndices.length > 0) {\n            for (const index of sizes.groupIndices) {\n              if (index - includedGroupsCount >= count) {\n                break\n              }\n              includedGroupsCount++\n            }\n          }\n          const adjustedCount = count + includedGroupsCount\n          const items = Array.from({ length: adjustedCount }).map((_, index) => ({ index, size: 0, offset: 0, data: data[index] }))\n          return buildListState(items, [], adjustedCount, sizes, firstItemIndex)\n        })\n      ),\n      listState\n    )\n\n    return { initialItemCount }\n  },\n  u.tup(sizeSystem, listStateSystem, propsReadySystem),\n  { singleton: true }\n)\n","import { connect, system, map, pipe, statefulStream, tup, filter } from '@virtuoso.dev/urx'\nimport { listStateSystem } from './listStateSystem'\n\nexport const topItemCountSystem = system(([{ topItemsIndexes }]) => {\n  const topItemCount = statefulStream(0)\n\n  connect(\n    pipe(\n      topItemCount,\n      filter((length) => length > 0),\n      map((length) => Array.from({ length }).map((_, index) => index))\n    ),\n    topItemsIndexes\n  )\n  return { topItemCount }\n}, tup(listStateSystem))\n","import * as u from '@virtuoso.dev/urx'\nimport { listStateSystem } from './listStateSystem'\nimport { domIOSystem } from './domIOSystem'\n\nexport const totalListHeightSystem = u.system(\n  ([{ footerHeight, headerHeight }, { listState }]) => {\n    const totalListHeightChanged = u.stream<number>()\n    const totalListHeight = u.statefulStreamFromEmitter(\n      u.pipe(\n        u.combineLatest(footerHeight, headerHeight, listState),\n        u.map(([footerHeight, headerHeight, listState]) => {\n          return footerHeight + headerHeight + listState.offsetBottom + listState.bottom\n        })\n      ),\n      0\n    )\n\n    u.connect(u.duc(totalListHeight), totalListHeightChanged)\n\n    return { totalListHeight, totalListHeightChanged }\n  },\n  u.tup(domIOSystem, listStateSystem),\n  { singleton: true }\n)\n","import * as u from '@virtuoso.dev/urx'\nimport { domIOSystem } from './domIOSystem'\nimport { listStateSystem } from './listStateSystem'\nimport { sizeSystem } from './sizeSystem'\nimport { UP, stateFlagsSystem } from './stateFlagsSystem'\nimport { ListItem } from './interfaces'\nimport { loggerSystem, LogLevel } from './loggerSystem'\n\n/**\n * Fixes upward scrolling by calculating and compensation from changed item heights, using scrollBy.\n */\nexport const upwardScrollFixSystem = u.system(\n  ([\n    { scrollBy, scrollTop, deviation, scrollingInProgress },\n    { isScrolling, isAtBottom, atBottomState, scrollDirection, lastJumpDueToItemResize },\n    { listState },\n    { beforeUnshiftWith, sizes },\n    { log },\n  ]) => {\n    const deviationOffset = u.streamFromEmitter(\n      u.pipe(\n        listState,\n        u.withLatestFrom(lastJumpDueToItemResize),\n        u.scan(\n          ([, prevItems, prevTotalCount], [{ items, totalCount }, lastJumpDueToItemResize]) => {\n            let newDev = 0\n            if (prevTotalCount === totalCount) {\n              if (prevItems.length > 0 && items.length > 0) {\n                const firstItemIndex = items[0].originalIndex\n                const prevFirstItemIndex = prevItems[0].originalIndex\n                const atStart = firstItemIndex === 0 && prevFirstItemIndex === 0\n                const onlyItem = items.length === 1\n\n                if (!atStart) {\n                  for (let index = items.length - 1; index >= 0; index--) {\n                    const item = items[index]\n\n                    const prevItem = prevItems.find((pItem) => pItem.originalIndex === item.originalIndex)\n\n                    if (!prevItem) {\n                      continue\n                    }\n\n                    if (item.offset !== prevItem.offset || onlyItem) {\n                      newDev = item.offset - prevItem.offset + item.size - prevItem.size\n                      break\n                    }\n                  }\n                }\n              }\n\n              if (newDev !== 0) {\n                newDev += lastJumpDueToItemResize\n              }\n            }\n\n            return [newDev, items, totalCount] as [number, ListItem<any>[], number]\n          },\n          [0, [], 0] as [number, ListItem<any>[], number]\n        ),\n        u.filter(([amount]) => amount !== 0),\n        u.withLatestFrom(scrollTop, scrollDirection, scrollingInProgress, log, isAtBottom, atBottomState),\n        u.filter(([, scrollTop, scrollDirection, scrollingInProgress]) => {\n          // console.log({ amount, scrollTop, scrollDirection, scrollingInProgress, isAtBottom, atBottomState })\n          return !scrollingInProgress && scrollTop !== 0 && scrollDirection === UP // && (isAtBottom ? amount > 0 : true)\n        }),\n        u.map(([[amount], , , , log]) => {\n          log('Upward scrolling compensation', { amount }, LogLevel.DEBUG)\n          return amount\n        })\n      )\n    )\n\n    u.connect(\n      u.pipe(\n        deviationOffset,\n        u.withLatestFrom(deviation),\n        u.map(([amount, deviation]) => deviation - amount)\n      ),\n      deviation\n    )\n\n    // when the browser stops scrolling,\n    // restore the position and reset the glitching\n    u.subscribe(\n      u.pipe(\n        u.combineLatest(u.statefulStreamFromEmitter(isScrolling, false), deviation),\n        u.filter(([is, deviation]) => !is && deviation !== 0),\n        u.map(([_, deviation]) => deviation),\n        u.throttleTime(1)\n      ),\n      (offset) => {\n        if (offset > 0) {\n          u.publish(scrollBy, { top: -offset, behavior: 'auto' })\n          u.publish(deviation, 0)\n        } else {\n          u.publish(deviation, 0)\n          u.publish(scrollBy, { top: -offset, behavior: 'auto' })\n        }\n      }\n    )\n\n    u.connect(\n      u.pipe(\n        beforeUnshiftWith,\n        u.withLatestFrom(sizes),\n        u.map(([offset, { lastSize }]) => offset * lastSize)\n      ),\n      deviationOffset\n    )\n\n    return { deviation }\n  },\n  u.tup(domIOSystem, stateFlagsSystem, listStateSystem, sizeSystem, loggerSystem)\n)\n","import * as u from '@virtuoso.dev/urx'\nimport { totalListHeightSystem } from './totalListHeightSystem'\nimport { propsReadySystem } from './propsReadySystem'\nimport { domIOSystem } from './domIOSystem'\n\nexport const initialScrollTopSystem = u.system(\n  ([{ totalListHeight }, { didMount }, { scrollTo }]) => {\n    const initialScrollTop = u.statefulStream(0)\n\n    u.subscribe(\n      u.pipe(\n        didMount,\n        u.withLatestFrom(initialScrollTop),\n        u.filter(([, offset]) => offset !== 0),\n        u.map(([, offset]) => ({ top: offset }))\n      ),\n      (location) => {\n        u.handleNext(\n          u.pipe(\n            totalListHeight,\n            u.filter((val) => val !== 0)\n          ),\n          () => {\n            setTimeout(() => {\n              u.publish(scrollTo, location)\n            })\n          }\n        )\n      }\n    )\n\n    return {\n      initialScrollTop,\n    }\n  },\n  u.tup(totalListHeightSystem, propsReadySystem, domIOSystem),\n  { singleton: true }\n)\n","import * as u from '@virtuoso.dev/urx'\nimport { totalListHeightSystem } from './totalListHeightSystem'\nimport { domIOSystem } from './domIOSystem'\n\nexport const alignToBottomSystem = u.system(\n  ([{ viewportHeight }, { totalListHeight }]) => {\n    const alignToBottom = u.statefulStream(false)\n\n    const paddingTopAddition = u.statefulStreamFromEmitter(\n      u.pipe(\n        u.combineLatest(alignToBottom, viewportHeight, totalListHeight),\n        u.filter(([enabled]) => enabled),\n        u.map(([, viewportHeight, totalListHeight]) => {\n          return Math.max(0, viewportHeight - totalListHeight)\n        }),\n        u.distinctUntilChanged()\n      ),\n      0\n    )\n\n    return { alignToBottom, paddingTopAddition }\n  },\n  u.tup(domIOSystem, totalListHeightSystem),\n  { singleton: true }\n)\n","import * as u from '@virtuoso.dev/urx'\nimport { findMaxKeyValue } from './AATree'\nimport { domIOSystem } from './domIOSystem'\nimport { offsetOf, originalIndexFromItemIndex, sizeSystem } from './sizeSystem'\nimport { loggerSystem } from './loggerSystem'\nimport { scrollToIndexSystem } from './scrollToIndexSystem'\nimport { listStateSystem } from './listStateSystem'\n\nexport interface ScrollIntoViewLocation {\n  index: number\n  behavior?: 'auto' | 'smooth'\n  done?: () => void\n}\n\nexport const scrollIntoViewSystem = u.system(\n  ([{ sizes, totalCount }, { scrollTop, viewportHeight, headerHeight, scrollingInProgress }, { scrollToIndex }]) => {\n    const scrollIntoView = u.stream<ScrollIntoViewLocation>()\n\n    u.connect(\n      u.pipe(\n        scrollIntoView,\n        u.withLatestFrom(sizes, viewportHeight, totalCount, headerHeight, scrollTop),\n        u.map(([{ index, behavior = 'auto', done }, sizes, viewportHeight, totalCount, headerHeight, scrollTop]) => {\n          const lastIndex = totalCount - 1\n          let location = null\n          index = originalIndexFromItemIndex(index, sizes)\n          index = Math.max(0, index, Math.min(lastIndex, index))\n\n          const itemTop = offsetOf(index, sizes.offsetTree) + headerHeight\n          if (itemTop < scrollTop) {\n            location = { index, behavior, align: 'start' }\n          } else {\n            const itemBottom = itemTop + findMaxKeyValue(sizes.sizeTree, index)[1]!\n\n            if (itemBottom > scrollTop + viewportHeight) {\n              location = { index, behavior, align: 'end' }\n            }\n          }\n\n          if (location) {\n            done &&\n              u.handleNext(\n                u.pipe(\n                  scrollingInProgress,\n                  u.skip(1),\n                  u.filter((value) => value === false)\n                ),\n                done\n              )\n          } else {\n            done && done()\n          }\n\n          return location\n        }),\n        u.filter((value) => value !== null)\n      ),\n      scrollToIndex\n    )\n\n    return {\n      scrollIntoView,\n    }\n  },\n  u.tup(sizeSystem, domIOSystem, scrollToIndexSystem, listStateSystem, loggerSystem),\n  { singleton: true }\n)\n","import * as u from '@virtuoso.dev/urx'\nimport { domIOSystem } from './domIOSystem'\nimport { followOutputSystem } from './followOutputSystem'\nimport { groupedListSystem } from './groupedListSystem'\nimport { initialItemCountSystem } from './initialItemCountSystem'\nimport { initialTopMostItemIndexSystem } from './initialTopMostItemIndexSystem'\nimport { listStateSystem } from './listStateSystem'\nimport { propsReadySystem } from './propsReadySystem'\nimport { scrollSeekSystem } from './scrollSeekSystem'\nimport { scrollToIndexSystem } from './scrollToIndexSystem'\nimport { sizeRangeSystem } from './sizeRangeSystem'\nimport { sizeSystem } from './sizeSystem'\nimport { topItemCountSystem } from './topItemCountSystem'\nimport { totalListHeightSystem } from './totalListHeightSystem'\nimport { upwardScrollFixSystem } from './upwardScrollFixSystem'\nimport { initialScrollTopSystem } from './initialScrollTopSystem'\nimport { alignToBottomSystem } from './alignToBottomSystem'\nimport { windowScrollerSystem } from './windowScrollerSystem'\nimport { loggerSystem } from './loggerSystem'\nimport { scrollIntoViewSystem } from './scrollIntoViewSystem'\n\n// workaround the growing list of systems below\n// fix this with 4.1 recursive conditional types\nconst featureGroup1System = u.system(\n  ([\n    sizeRange,\n    initialItemCount,\n    propsReady,\n    scrollSeek,\n    totalListHeight,\n    initialScrollTopSystem,\n    alignToBottom,\n    windowScroller,\n    scrollIntoView,\n  ]) => {\n    return {\n      ...sizeRange,\n      ...initialItemCount,\n      ...propsReady,\n      ...scrollSeek,\n      ...totalListHeight,\n      ...initialScrollTopSystem,\n      ...alignToBottom,\n      ...windowScroller,\n      ...scrollIntoView,\n    }\n  },\n  u.tup(\n    sizeRangeSystem,\n    initialItemCountSystem,\n    propsReadySystem,\n    scrollSeekSystem,\n    totalListHeightSystem,\n    initialScrollTopSystem,\n    alignToBottomSystem,\n    windowScrollerSystem,\n    scrollIntoViewSystem\n  )\n)\n\nexport const listSystem = u.system(\n  ([\n    { totalCount, sizeRanges, fixedItemSize, defaultItemSize, trackItemSizes, itemSize, data, firstItemIndex, groupIndices },\n    { initialTopMostItemIndex, scrolledToInitialItem },\n    domIO,\n    followOutput,\n    { listState, topItemsIndexes, ...flags },\n    { scrollToIndex },\n    _,\n    { topItemCount },\n    { groupCounts },\n    featureGroup1,\n    log,\n  ]) => {\n    u.connect(flags.rangeChanged, featureGroup1.scrollSeekRangeChanged)\n    u.connect(u.pipe(featureGroup1.windowViewportRect, u.map(u.prop('visibleHeight'))), domIO.viewportHeight)\n\n    return {\n      // input\n      totalCount,\n      data,\n      firstItemIndex,\n      sizeRanges,\n      initialTopMostItemIndex,\n      scrolledToInitialItem,\n      topItemsIndexes,\n      topItemCount,\n      groupCounts,\n      fixedItemHeight: fixedItemSize,\n      defaultItemHeight: defaultItemSize,\n      ...followOutput,\n\n      // output\n      listState,\n      scrollToIndex,\n      trackItemSizes,\n      itemSize,\n      groupIndices,\n\n      // exported from stateFlagsSystem\n      ...flags,\n      // the bag of IO from featureGroup1System\n      ...featureGroup1,\n      ...domIO,\n      ...log,\n    }\n  },\n  u.tup(\n    sizeSystem,\n    initialTopMostItemIndexSystem,\n    domIOSystem,\n    followOutputSystem,\n    listStateSystem,\n    scrollToIndexSystem,\n    upwardScrollFixSystem,\n    topItemCountSystem,\n    groupedListSystem,\n    featureGroup1System,\n    loggerSystem\n  )\n)\n","import { simpleMemoize } from './simpleMemoize'\n\nconst WEBKIT_STICKY = '-webkit-sticky'\nconst STICKY = 'sticky'\n\nexport const positionStickyCssValue = simpleMemoize(() => {\n  if (typeof document === 'undefined') {\n    return STICKY\n  }\n  const node = document.createElement('div')\n  node.style.position = WEBKIT_STICKY\n  return node.style.position === WEBKIT_STICKY ? WEBKIT_STICKY : STICKY\n})\n","export function simpleMemoize<T extends () => any>(func: T): T {\n  let called = false\n  let result: unknown\n\n  return (() => {\n    if (!called) {\n      called = true\n      result = func()\n    }\n    return result\n  }) as T\n}\n","import { RefHandle, systemToComponent } from '@virtuoso.dev/react-urx'\nimport {\n  compose,\n  connect,\n  getValue,\n  map,\n  pipe,\n  publish,\n  statefulStream,\n  stream,\n  Stream,\n  subscribe,\n  system,\n  tup,\n  withLatestFrom,\n  statefulStreamFromEmitter,\n  distinctUntilChanged,\n  noop,\n} from '@virtuoso.dev/urx'\nimport * as React from 'react'\nimport { createElement, CSSProperties, FC } from 'react'\nimport useIsomorphicLayoutEffect from './hooks/useIsomorphicLayoutEffect'\nimport useChangedListContentsSizes from './hooks/useChangedChildSizes'\nimport useScrollTop from './hooks/useScrollTop'\nimport useSize from './hooks/useSize'\nimport { Components, ComputeItemKey, GroupContent, GroupItemContent, ItemContent, ListRootProps } from './interfaces'\nimport { listSystem } from './listSystem'\nimport { positionStickyCssValue } from './utils/positionStickyCssValue'\nimport useWindowViewportRectRef from './hooks/useWindowViewportRect'\nimport { correctItemSize } from './utils/correctItemSize'\n\nexport function identity<T>(value: T) {\n  return value\n}\n\nconst listComponentPropsSystem = system(() => {\n  const itemContent = statefulStream<ItemContent<any> | GroupItemContent<any>>((index: number) => `Item ${index}`)\n  const groupContent = statefulStream<GroupContent>((index: number) => `Group ${index}`)\n  const components = statefulStream<Components>({})\n  const computeItemKey = statefulStream<ComputeItemKey<any>>(identity)\n  const headerFooterTag = statefulStream('div')\n  const scrollerRef = statefulStream<(ref: HTMLElement | Window | null) => void>(noop)\n\n  const distinctProp = <K extends keyof Components>(propName: K, defaultValue: Components[K] | null | 'div' = null) => {\n    return statefulStreamFromEmitter(\n      pipe(\n        components,\n        map((components) => components[propName]),\n        distinctUntilChanged()\n      ),\n      defaultValue\n    )\n  }\n\n  return {\n    itemContent,\n    groupContent,\n    components,\n    computeItemKey,\n    headerFooterTag,\n    scrollerRef,\n    FooterComponent: distinctProp('Footer'),\n    HeaderComponent: distinctProp('Header'),\n    TopItemListComponent: distinctProp('TopItemList'),\n    ListComponent: distinctProp('List', 'div'),\n    ItemComponent: distinctProp('Item', 'div'),\n    GroupComponent: distinctProp('Group', 'div'),\n    ScrollerComponent: distinctProp('Scroller', 'div'),\n    EmptyPlaceholder: distinctProp('EmptyPlaceholder'),\n    ScrollSeekPlaceholder: distinctProp('ScrollSeekPlaceholder'),\n  }\n})\n\nexport function addDeprecatedAlias<T>(prop: Stream<T>, message: string) {\n  const alias = stream<T>()\n  subscribe(alias, () =>\n    console.warn(`react-virtuoso: You are using a deprecated property. ${message}`, 'color: red;', 'color: inherit;', 'color: blue;')\n  )\n  connect(alias, prop)\n  return alias\n}\n\nconst combinedSystem = system(([listSystem, propsSystem]) => {\n  const deprecatedProps = {\n    item: addDeprecatedAlias(propsSystem.itemContent, 'Rename the %citem%c prop to %citemContent.'),\n    group: addDeprecatedAlias(propsSystem.groupContent, 'Rename the %cgroup%c prop to %cgroupContent.'),\n    topItems: addDeprecatedAlias(listSystem.topItemCount, 'Rename the %ctopItems%c prop to %ctopItemCount.'),\n    itemHeight: addDeprecatedAlias(listSystem.fixedItemHeight, 'Rename the %citemHeight%c prop to %cfixedItemHeight.'),\n    scrollingStateChange: addDeprecatedAlias(listSystem.isScrolling, 'Rename the %cscrollingStateChange%c prop to %cisScrolling.'),\n    adjustForPrependedItems: stream<any>(),\n    maxHeightCacheSize: stream<any>(),\n    footer: stream<any>(),\n    header: stream<any>(),\n    HeaderContainer: stream<any>(),\n    FooterContainer: stream<any>(),\n    ItemContainer: stream<any>(),\n    ScrollContainer: stream<any>(),\n    GroupContainer: stream<any>(),\n    ListContainer: stream<any>(),\n    emptyComponent: stream<any>(),\n    scrollSeek: stream<any>(),\n  }\n\n  subscribe(deprecatedProps.adjustForPrependedItems, () => {\n    console.warn(\n      `react-virtuoso: adjustForPrependedItems is no longer supported. Use the firstItemIndex property instead - https://virtuoso.dev/prepend-items.`,\n      'color: red;',\n      'color: inherit;',\n      'color: blue;'\n    )\n  })\n\n  subscribe(deprecatedProps.maxHeightCacheSize, () => {\n    console.warn(`react-virtuoso: maxHeightCacheSize is no longer necessary. Setting it has no effect - remove it from your code.`)\n  })\n\n  subscribe(deprecatedProps.HeaderContainer, () => {\n    console.warn(\n      `react-virtuoso: HeaderContainer is deprecated. Use headerFooterTag if you want to change the wrapper of the header component and pass components.Header to change its contents.`\n    )\n  })\n\n  subscribe(deprecatedProps.FooterContainer, () => {\n    console.warn(\n      `react-virtuoso: FooterContainer is deprecated. Use headerFooterTag if you want to change the wrapper of the footer component and pass components.Footer to change its contents.`\n    )\n  })\n\n  function deprecateComponentProp(stream: Stream<any>, componentName: string, propName: string) {\n    connect(\n      pipe(\n        stream,\n        withLatestFrom(propsSystem.components),\n        map(([comp, components]) => {\n          console.warn(`react-virtuoso: ${propName} property is deprecated. Pass components.${componentName} instead.`)\n          // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n          return { ...components, [componentName]: comp }\n        })\n      ),\n      propsSystem.components\n    )\n  }\n\n  subscribe(deprecatedProps.scrollSeek, ({ placeholder, ...config }) => {\n    console.warn(\n      `react-virtuoso: scrollSeek property is deprecated. Pass scrollSeekConfiguration and specify the placeholder in components.ScrollSeekPlaceholder instead.`\n    )\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    publish(propsSystem.components, { ...getValue(propsSystem.components), ScrollSeekPlaceholder: placeholder })\n    publish(listSystem.scrollSeekConfiguration, config)\n  })\n\n  deprecateComponentProp(deprecatedProps.footer, 'Footer', 'footer')\n  deprecateComponentProp(deprecatedProps.header, 'Header', 'header')\n  deprecateComponentProp(deprecatedProps.ItemContainer, 'Item', 'ItemContainer')\n  deprecateComponentProp(deprecatedProps.ListContainer, 'List', 'ListContainer')\n  deprecateComponentProp(deprecatedProps.ScrollContainer, 'Scroller', 'ScrollContainer')\n  deprecateComponentProp(deprecatedProps.emptyComponent, 'EmptyPlaceholder', 'emptyComponent')\n  deprecateComponentProp(deprecatedProps.GroupContainer, 'Group', 'GroupContainer')\n\n  return { ...listSystem, ...propsSystem, ...deprecatedProps }\n}, tup(listSystem, listComponentPropsSystem))\n\nconst DefaultScrollSeekPlaceholder = ({ height }: { height: number }) => <div style={{ height }}></div>\n\nconst GROUP_STYLE = { position: positionStickyCssValue(), zIndex: 1, overflowAnchor: 'none' }\n\nexport const Items = React.memo(function VirtuosoItems({ showTopList = false }: { showTopList?: boolean }) {\n  const listState = useEmitterValue('listState')\n  const deviation = useEmitterValue('deviation')\n  const sizeRanges = usePublisher('sizeRanges')\n  const useWindowScroll = useEmitterValue('useWindowScroll')\n  const scrollElement = useEmitterValue('scrollElement')\n  const windowScrollContainerStateCallback = usePublisher('windowScrollContainerState')\n  const _scrollContainerStateCallback = usePublisher('scrollContainerState')\n  const scrollContainerStateCallback = scrollElement || useWindowScroll ? windowScrollContainerStateCallback : _scrollContainerStateCallback\n  const itemContent = useEmitterValue('itemContent')\n  const groupContent = useEmitterValue('groupContent')\n  const trackItemSizes = useEmitterValue('trackItemSizes')\n  const itemSize = useEmitterValue('itemSize')\n  const log = useEmitterValue('log')\n\n  const ref = useChangedListContentsSizes(\n    sizeRanges,\n    itemSize,\n    trackItemSizes,\n    showTopList ? noop : scrollContainerStateCallback,\n    log,\n    scrollElement\n  )\n  const EmptyPlaceholder = useEmitterValue('EmptyPlaceholder')\n  const ScrollSeekPlaceholder = useEmitterValue('ScrollSeekPlaceholder') || DefaultScrollSeekPlaceholder\n  const ListComponent = useEmitterValue('ListComponent')!\n  const ItemComponent = useEmitterValue('ItemComponent')!\n  const GroupComponent = useEmitterValue('GroupComponent')!\n  const computeItemKey = useEmitterValue('computeItemKey')\n  const isSeeking = useEmitterValue('isSeeking')\n  const hasGroups = useEmitterValue('groupIndices').length > 0\n  const paddingTopAddition = useEmitterValue('paddingTopAddition')\n  const scrolledToInitialItem = useEmitterValue('scrolledToInitialItem')\n  const firstItemIndex = useEmitterValue('firstItemIndex')\n\n  const containerStyle: CSSProperties = showTopList\n    ? {}\n    : {\n        boxSizing: 'border-box',\n        paddingTop: listState.offsetTop + paddingTopAddition,\n        paddingBottom: listState.offsetBottom,\n        marginTop: deviation,\n      }\n\n  if (!showTopList && listState.items.length === 0 && EmptyPlaceholder && scrolledToInitialItem) {\n    return createElement(EmptyPlaceholder)\n  }\n\n  return createElement(\n    ListComponent,\n    { ref, style: containerStyle, 'data-test-id': showTopList ? 'virtuoso-top-item-list' : 'virtuoso-item-list' },\n    (showTopList ? listState.topItems : listState.items).map((item: any) => {\n      const index = item.originalIndex!\n      const key = computeItemKey(index + firstItemIndex, item.data)\n\n      if (isSeeking) {\n        return createElement(ScrollSeekPlaceholder, {\n          key,\n          index: item.index,\n          height: item.size,\n          type: item.type || 'item',\n          ...(item.type === 'group' ? {} : { groupIndex: item.groupIndex }),\n        })\n      }\n\n      if (item.type === 'group') {\n        return createElement(\n          GroupComponent,\n          {\n            key,\n            'data-index': index,\n            'data-known-size': item.size,\n            'data-item-index': item.index,\n            style: GROUP_STYLE,\n          } as any,\n          groupContent(item.index)\n        )\n      } else {\n        return createElement(\n          ItemComponent,\n          {\n            key,\n            'data-index': index,\n            'data-known-size': item.size,\n            'data-item-index': item.index,\n            'data-item-group-index': item.groupIndex,\n            style: { overflowAnchor: 'none' },\n          } as any,\n          hasGroups\n            ? (itemContent as GroupItemContent<any>)(item.index, item.groupIndex!, item.data)\n            : (itemContent as ItemContent<any>)(item.index, item.data)\n        )\n      }\n    })\n  )\n})\n\nexport const scrollerStyle: CSSProperties = {\n  height: '100%',\n  outline: 'none',\n  overflowY: 'auto',\n  position: 'relative',\n  WebkitOverflowScrolling: 'touch',\n}\n\nexport const viewportStyle: CSSProperties = {\n  width: '100%',\n  height: '100%',\n  position: 'absolute',\n  top: 0,\n}\n\nconst topItemListStyle: CSSProperties = {\n  width: '100%',\n  position: positionStickyCssValue(),\n  top: 0,\n}\n\nconst Header: FC = React.memo(function VirtuosoHeader() {\n  const Header = useEmitterValue('HeaderComponent')\n  const headerHeight = usePublisher('headerHeight')\n  const headerFooterTag = useEmitterValue('headerFooterTag')\n  const ref = useSize((el) => headerHeight(correctItemSize(el, 'height')))\n  return Header ? createElement(headerFooterTag, { ref }, createElement(Header)) : null\n})\n\nconst Footer: FC = React.memo(function VirtuosoFooter() {\n  const Footer = useEmitterValue('FooterComponent')\n  const footerHeight = usePublisher('footerHeight')\n  const headerFooterTag = useEmitterValue('headerFooterTag')\n  const ref = useSize((el) => footerHeight(correctItemSize(el, 'height')))\n  return Footer ? createElement(headerFooterTag, { ref }, createElement(Footer)) : null\n})\n\nexport interface Hooks {\n  usePublisher: typeof usePublisher\n  useEmitterValue: typeof useEmitterValue\n  useEmitter: typeof useEmitter\n}\n\nexport function buildScroller({ usePublisher, useEmitter, useEmitterValue }: Hooks) {\n  const Scroller: Components['Scroller'] = React.memo(function VirtuosoScroller({ style, children, ...props }) {\n    const scrollContainerStateCallback = usePublisher('scrollContainerState')\n    const ScrollerComponent = useEmitterValue('ScrollerComponent')!\n    const smoothScrollTargetReached = usePublisher('smoothScrollTargetReached')\n    const scrollerRefCallback = useEmitterValue('scrollerRef')\n\n    const { scrollerRef, scrollByCallback, scrollToCallback } = useScrollTop(\n      scrollContainerStateCallback,\n      smoothScrollTargetReached,\n      ScrollerComponent,\n      scrollerRefCallback\n    )\n\n    useEmitter('scrollTo', scrollToCallback)\n    useEmitter('scrollBy', scrollByCallback)\n    return createElement(\n      ScrollerComponent,\n      {\n        ref: scrollerRef as React.MutableRefObject<HTMLDivElement | null>,\n        style: { ...scrollerStyle, ...style },\n        'data-test-id': 'virtuoso-scroller',\n        //@ts-expect-error what?\n        'data-virtuoso-scroller': 'true',\n        tabIndex: 0,\n        ...props,\n      },\n      children\n    )\n  })\n  return Scroller\n}\n\nexport function buildWindowScroller({ usePublisher, useEmitter, useEmitterValue }: Hooks) {\n  const Scroller: Components['Scroller'] = React.memo(function VirtuosoWindowScroller({ style, children, ...props }) {\n    const scrollContainerStateCallback = usePublisher('windowScrollContainerState')\n    const ScrollerComponent = useEmitterValue('ScrollerComponent')!\n    const smoothScrollTargetReached = usePublisher('smoothScrollTargetReached')\n    const totalListHeight = useEmitterValue('totalListHeight')\n    const deviation = useEmitterValue('deviation')\n    const scrollElement = useEmitterValue('scrollElement')\n    const { scrollerRef, scrollByCallback, scrollToCallback } = useScrollTop(\n      scrollContainerStateCallback,\n      smoothScrollTargetReached,\n      ScrollerComponent,\n      noop,\n      scrollElement\n    )\n\n    useIsomorphicLayoutEffect(() => {\n      scrollerRef.current = scrollElement ? scrollElement : window\n      return () => {\n        scrollerRef.current = null\n      }\n    }, [scrollerRef, scrollElement])\n\n    useEmitter('windowScrollTo', scrollToCallback)\n    useEmitter('scrollBy', scrollByCallback)\n    return createElement(\n      ScrollerComponent,\n      {\n        style: { position: 'relative', ...style, ...(totalListHeight !== 0 ? { height: totalListHeight + deviation } : {}) },\n        //@ts-expect-error what?\n        'data-virtuoso-scroller': 'true',\n        ...props,\n      },\n      children\n    )\n  })\n  return Scroller\n}\n\nconst Viewport: FC = ({ children }) => {\n  const viewportHeight = usePublisher('viewportHeight')\n  const viewportRef = useSize(compose(viewportHeight, (el) => correctItemSize(el, 'height')))\n\n  return (\n    <div style={viewportStyle} ref={viewportRef} data-viewport-type=\"element\">\n      {children}\n    </div>\n  )\n}\n\nconst WindowViewport: FC = ({ children }) => {\n  const windowViewportRect = usePublisher('windowViewportRect')\n  const scrollElement = useEmitterValue('scrollElement')\n  const viewportRef = useWindowViewportRectRef(windowViewportRect, scrollElement)\n\n  return (\n    <div ref={viewportRef} style={viewportStyle} data-viewport-type=\"window\">\n      {children}\n    </div>\n  )\n}\n\nconst TopItemListContainer: FC = ({ children }) => {\n  const TopItemList = useEmitterValue('TopItemListComponent')\n  const headerHeight = useEmitterValue('headerHeight')\n  const style = { ...topItemListStyle, marginTop: `${headerHeight}px` }\n  return createElement(TopItemList || 'div', { style }, children)\n}\n\nconst ListRoot: FC<ListRootProps> = React.memo(function VirtuosoRoot(props) {\n  const useWindowScroll = useEmitterValue('useWindowScroll')\n  const showTopList = useEmitterValue('topItemsIndexes').length > 0\n  const scrollElement = useEmitterValue('scrollElement')\n  const TheScroller = scrollElement || useWindowScroll ? WindowScroller : Scroller\n  const TheViewport = scrollElement || useWindowScroll ? WindowViewport : Viewport\n  return (\n    <TheScroller {...props}>\n      <TheViewport>\n        <Header />\n        <Items />\n        <Footer />\n      </TheViewport>\n      {showTopList && (\n        <TopItemListContainer>\n          <Items showTopList={true} />\n        </TopItemListContainer>\n      )}\n    </TheScroller>\n  )\n})\n\nexport type ListHandle = RefHandle<typeof List>\n\nexport const { Component: List, usePublisher, useEmitterValue, useEmitter } = systemToComponent(\n  combinedSystem,\n  {\n    required: {},\n    optional: {\n      followOutput: 'followOutput',\n      firstItemIndex: 'firstItemIndex',\n      itemContent: 'itemContent',\n      groupContent: 'groupContent',\n      overscan: 'overscan',\n      increaseViewportBy: 'increaseViewportBy',\n      totalCount: 'totalCount',\n      topItemCount: 'topItemCount',\n      initialTopMostItemIndex: 'initialTopMostItemIndex',\n      components: 'components',\n      groupCounts: 'groupCounts',\n      atBottomThreshold: 'atBottomThreshold',\n      computeItemKey: 'computeItemKey',\n      defaultItemHeight: 'defaultItemHeight',\n      fixedItemHeight: 'fixedItemHeight',\n      itemSize: 'itemSize',\n      scrollSeekConfiguration: 'scrollSeekConfiguration',\n      headerFooterTag: 'headerFooterTag',\n      data: 'data',\n      initialItemCount: 'initialItemCount',\n      initialScrollTop: 'initialScrollTop',\n      alignToBottom: 'alignToBottom',\n      useWindowScroll: 'useWindowScroll',\n      scrollElement: 'scrollElement',\n      scrollerRef: 'scrollerRef',\n      logLevel: 'logLevel',\n\n      // deprecated\n      item: 'item',\n      group: 'group',\n      topItems: 'topItems',\n      itemHeight: 'itemHeight',\n      scrollingStateChange: 'scrollingStateChange',\n      maxHeightCacheSize: 'maxHeightCacheSize',\n      footer: 'footer',\n      header: 'header',\n      ItemContainer: 'ItemContainer',\n      ScrollContainer: 'ScrollContainer',\n      ListContainer: 'ListContainer',\n      GroupContainer: 'GroupContainer',\n      emptyComponent: 'emptyComponent',\n      HeaderContainer: 'HeaderContainer',\n      FooterContainer: 'FooterContainer',\n      scrollSeek: 'scrollSeek',\n    },\n    methods: {\n      scrollToIndex: 'scrollToIndex',\n      scrollIntoView: 'scrollIntoView',\n      scrollTo: 'scrollTo',\n      scrollBy: 'scrollBy',\n      adjustForPrependedItems: 'adjustForPrependedItems',\n    },\n    events: {\n      isScrolling: 'isScrolling',\n      endReached: 'endReached',\n      startReached: 'startReached',\n      rangeChanged: 'rangeChanged',\n      atBottomStateChange: 'atBottomStateChange',\n      atTopStateChange: 'atTopStateChange',\n      totalListHeightChanged: 'totalListHeightChanged',\n      itemsRendered: 'itemsRendered',\n      groupIndices: 'groupIndices',\n    },\n  },\n  ListRoot\n)\n\nconst Scroller = buildScroller({ usePublisher, useEmitterValue, useEmitter })\nconst WindowScroller = buildWindowScroller({ usePublisher, useEmitterValue, useEmitter })\n","import { RefHandle, systemToComponent } from '@virtuoso.dev/react-urx'\n\nimport * as u from '@virtuoso.dev/urx'\nimport * as React from 'react'\nimport { createElement, FC } from 'react'\nimport { gridSystem } from './gridSystem'\nimport useSize from './hooks/useSize'\nimport useWindowViewportRectRef from './hooks/useWindowViewportRect'\nimport { GridComponents, GridComputeItemKey, GridItemContent, GridRootProps } from './interfaces'\nimport { addDeprecatedAlias, buildScroller, buildWindowScroller, identity, viewportStyle } from './List'\n\nconst gridComponentPropsSystem = u.system(() => {\n  const itemContent = u.statefulStream<GridItemContent>((index) => `Item ${index}`)\n  const components = u.statefulStream<GridComponents>({})\n  const itemClassName = u.statefulStream('virtuoso-grid-item')\n  const listClassName = u.statefulStream('virtuoso-grid-list')\n  const computeItemKey = u.statefulStream<GridComputeItemKey>(identity)\n  const scrollerRef = u.statefulStream<(ref: HTMLElement | null) => void>(u.noop)\n\n  const distinctProp = <K extends keyof GridComponents>(propName: K, defaultValue: GridComponents[K] | null | 'div' = null) => {\n    return u.statefulStreamFromEmitter(\n      u.pipe(\n        components,\n        u.map((components) => components[propName]),\n        u.distinctUntilChanged()\n      ),\n      defaultValue\n    )\n  }\n\n  return {\n    itemContent,\n    components,\n    computeItemKey,\n    itemClassName,\n    listClassName,\n    scrollerRef,\n    ListComponent: distinctProp('List', 'div'),\n    ItemComponent: distinctProp('Item', 'div'),\n    ScrollerComponent: distinctProp('Scroller', 'div'),\n    ScrollSeekPlaceholder: distinctProp('ScrollSeekPlaceholder', 'div'),\n  }\n})\n\nconst combinedSystem = u.system(([gridSystem, gridComponentPropsSystem]) => {\n  const deprecatedProps = {\n    item: addDeprecatedAlias(gridComponentPropsSystem.itemContent, 'Rename the %citem%c prop to %citemContent.'),\n    ItemContainer: u.stream<any>(),\n    ScrollContainer: u.stream<any>(),\n    ListContainer: u.stream<any>(),\n    emptyComponent: u.stream<any>(),\n    scrollSeek: u.stream<any>(),\n  }\n\n  function deprecateComponentProp(stream: u.Stream<any>, componentName: string, propName: string) {\n    u.connect(\n      u.pipe(\n        stream,\n        u.withLatestFrom(gridComponentPropsSystem.components),\n        u.map(([comp, components]) => {\n          console.warn(`react-virtuoso: ${propName} property is deprecated. Pass components.${componentName} instead.`)\n          // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n          return { ...components, [componentName]: comp }\n        })\n      ),\n      gridComponentPropsSystem.components\n    )\n  }\n\n  u.subscribe(deprecatedProps.scrollSeek, ({ placeholder, ...config }) => {\n    console.warn(\n      `react-virtuoso: scrollSeek property is deprecated. Pass scrollSeekConfiguration and specify the placeholder in components.ScrollSeekPlaceholder instead.`\n    )\n    u.publish(gridComponentPropsSystem.components, {\n      ...u.getValue(gridComponentPropsSystem.components),\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n      ScrollSeekPlaceholder: placeholder,\n    })\n    u.publish(gridSystem.scrollSeekConfiguration, config)\n  })\n\n  deprecateComponentProp(deprecatedProps.ItemContainer, 'Item', 'ItemContainer')\n  deprecateComponentProp(deprecatedProps.ListContainer, 'List', 'ListContainer')\n  deprecateComponentProp(deprecatedProps.ScrollContainer, 'Scroller', 'ScrollContainer')\n\n  return { ...gridSystem, ...gridComponentPropsSystem, ...deprecatedProps }\n}, u.tup(gridSystem, gridComponentPropsSystem))\n\nconst GridItems: FC = React.memo(function GridItems() {\n  const gridState = useEmitterValue('gridState')\n  const listClassName = useEmitterValue('listClassName')\n  const itemClassName = useEmitterValue('itemClassName')\n  const itemContent = useEmitterValue('itemContent')\n  const computeItemKey = useEmitterValue('computeItemKey')\n  const isSeeking = useEmitterValue('isSeeking')\n  const scrollHeightCallback = usePublisher('scrollHeight')\n  const ItemComponent = useEmitterValue('ItemComponent')!\n  const ListComponent = useEmitterValue('ListComponent')!\n  const ScrollSeekPlaceholder = useEmitterValue('ScrollSeekPlaceholder')!\n\n  const itemDimensions = usePublisher('itemDimensions')\n\n  const listRef = useSize((el) => {\n    const scrollHeight = el.parentElement!.parentElement!.scrollHeight\n    scrollHeightCallback(scrollHeight)\n    const firstItem = el.firstChild as HTMLElement\n    if (firstItem) {\n      itemDimensions(firstItem.getBoundingClientRect())\n    }\n  })\n\n  return createElement(\n    ListComponent,\n    { ref: listRef, className: listClassName, style: { paddingTop: gridState.offsetTop, paddingBottom: gridState.offsetBottom } },\n    gridState.items.map((item) => {\n      const key = computeItemKey(item.index)\n      return isSeeking\n        ? createElement(ScrollSeekPlaceholder, { key, index: item.index, height: gridState.itemHeight, width: gridState.itemWidth })\n        : createElement(ItemComponent, { className: itemClassName, 'data-index': item.index, key }, itemContent(item.index))\n    })\n  )\n})\n\nconst Viewport: FC = ({ children }) => {\n  const viewportDimensions = usePublisher('viewportDimensions')\n\n  const viewportRef = useSize((el) => {\n    viewportDimensions(el.getBoundingClientRect())\n  })\n\n  return (\n    <div style={viewportStyle} ref={viewportRef}>\n      {children}\n    </div>\n  )\n}\n\nconst WindowViewport: FC = ({ children }) => {\n  const windowViewportRect = usePublisher('windowViewportRect')\n  const scrollElement = useEmitterValue('scrollElement')\n  const viewportRef = useWindowViewportRectRef(windowViewportRect, scrollElement)\n\n  return (\n    <div ref={viewportRef} style={viewportStyle}>\n      {children}\n    </div>\n  )\n}\n\nconst GridRoot: FC<GridRootProps> = React.memo(function GridRoot({ ...props }) {\n  const useWindowScroll = useEmitterValue('useWindowScroll')\n  const scrollElement = useEmitterValue('scrollElement')\n  const TheScroller = scrollElement || useWindowScroll ? WindowScroller : Scroller\n  const TheViewport = scrollElement || useWindowScroll ? WindowViewport : Viewport\n\n  return (\n    <TheScroller {...props}>\n      <TheViewport>\n        <GridItems />\n      </TheViewport>\n    </TheScroller>\n  )\n})\n\nconst { Component: Grid, usePublisher, useEmitterValue, useEmitter } = systemToComponent(\n  combinedSystem,\n  {\n    optional: {\n      totalCount: 'totalCount',\n      overscan: 'overscan',\n      itemContent: 'itemContent',\n      components: 'components',\n      computeItemKey: 'computeItemKey',\n      initialItemCount: 'initialItemCount',\n      scrollSeekConfiguration: 'scrollSeekConfiguration',\n      listClassName: 'listClassName',\n      itemClassName: 'itemClassName',\n      useWindowScroll: 'useWindowScroll',\n      scrollElement: 'scrollElement',\n      scrollerRef: 'scrollerRef',\n\n      // deprecated\n      item: 'item',\n      ItemContainer: 'ItemContainer',\n      ScrollContainer: 'ScrollContainer',\n      ListContainer: 'ListContainer',\n      scrollSeek: 'scrollSeek',\n    },\n    methods: {\n      scrollTo: 'scrollTo',\n      scrollBy: 'scrollBy',\n      scrollToIndex: 'scrollToIndex',\n    },\n    events: {\n      isScrolling: 'isScrolling',\n      endReached: 'endReached',\n      startReached: 'startReached',\n      rangeChanged: 'rangeChanged',\n      atBottomStateChange: 'atBottomStateChange',\n      atTopStateChange: 'atTopStateChange',\n    },\n  },\n  GridRoot\n)\n\nexport type foo<T> = T extends React.ForwardRefExoticComponent<React.RefAttributes<infer Handle>> ? Handle : never\n\nexport type GridHandle = RefHandle<typeof Grid>\nexport { Grid }\n\nconst Scroller = buildScroller({ usePublisher, useEmitterValue, useEmitter })\nconst WindowScroller = buildWindowScroller({ usePublisher, useEmitterValue, useEmitter })\n","import { RefHandle, systemToComponent } from '@virtuoso.dev/react-urx'\nimport { map, pipe, statefulStream, system, tup, statefulStreamFromEmitter, distinctUntilChanged, noop, compose } from '@virtuoso.dev/urx'\nimport * as React from 'react'\nimport { createElement, FC } from 'react'\nimport useChangedListContentsSizes from './hooks/useChangedChildSizes'\nimport { ComputeItemKey, ItemContent, FixedHeaderContent, TableComponents, TableRootProps } from './interfaces'\nimport { listSystem } from './listSystem'\nimport { identity, buildScroller, buildWindowScroller, viewportStyle } from './List'\nimport useSize from './hooks/useSize'\nimport { correctItemSize } from './utils/correctItemSize'\nimport useWindowViewportRectRef from './hooks/useWindowViewportRect'\n\nconst tableComponentPropsSystem = system(() => {\n  const itemContent = statefulStream<ItemContent<any>>((index: number) => <td>Item ${index}</td>)\n  const fixedHeaderContent = statefulStream<FixedHeaderContent>(null)\n  const components = statefulStream<TableComponents>({})\n  const computeItemKey = statefulStream<ComputeItemKey<any>>(identity)\n  const scrollerRef = statefulStream<(ref: HTMLElement | Window | null) => void>(noop)\n\n  const distinctProp = <K extends keyof TableComponents>(\n    propName: K,\n    defaultValue: TableComponents[K] | null | 'thead' | 'table' | 'tbody' | 'tr' | 'div' = null\n  ) => {\n    return statefulStreamFromEmitter(\n      pipe(\n        components,\n        map((components) => components[propName]),\n        distinctUntilChanged()\n      ),\n      defaultValue\n    )\n  }\n\n  return {\n    itemContent,\n    fixedHeaderContent,\n    components,\n    computeItemKey,\n    scrollerRef,\n    TableComponent: distinctProp('Table', 'table'),\n    TableHeadComponent: distinctProp('TableHead', 'thead'),\n    TableBodyComponent: distinctProp('TableBody', 'tbody'),\n    TableRowComponent: distinctProp('TableRow', 'tr'),\n    ScrollerComponent: distinctProp('Scroller', 'div'),\n    EmptyPlaceholder: distinctProp('EmptyPlaceholder'),\n    ScrollSeekPlaceholder: distinctProp('ScrollSeekPlaceholder'),\n  }\n})\n\nconst combinedSystem = system(([listSystem, propsSystem]) => {\n  return { ...listSystem, ...propsSystem }\n}, tup(listSystem, tableComponentPropsSystem))\n\nconst DefaultScrollSeekPlaceholder = ({ height }: { height: number }) => (\n  <tr>\n    <td style={{ height }}></td>\n  </tr>\n)\n\nconst FillerRow = ({ height }: { height: number }) => (\n  <tr>\n    <td style={{ height: height, padding: 0, border: 0 }}></td>\n  </tr>\n)\n\nexport const Items = React.memo(function VirtuosoItems() {\n  const listState = useEmitterValue('listState')\n  const deviation = useEmitterValue('deviation')\n  const sizeRanges = usePublisher('sizeRanges')\n  const useWindowScroll = useEmitterValue('useWindowScroll')\n  const scrollElement = useEmitterValue('scrollElement')\n  const windowScrollContainerStateCallback = usePublisher('windowScrollContainerState')\n  const _scrollContainerStateCallback = usePublisher('scrollContainerState')\n  const scrollContainerStateCallback = scrollElement || useWindowScroll ? windowScrollContainerStateCallback : _scrollContainerStateCallback\n  const itemContent = useEmitterValue('itemContent')\n  const trackItemSizes = useEmitterValue('trackItemSizes')\n  const itemSize = useEmitterValue('itemSize')\n  const log = useEmitterValue('log')\n\n  const ref = useChangedListContentsSizes(sizeRanges, itemSize, trackItemSizes, scrollContainerStateCallback, log, scrollElement)\n  const EmptyPlaceholder = useEmitterValue('EmptyPlaceholder')\n  const ScrollSeekPlaceholder = useEmitterValue('ScrollSeekPlaceholder') || DefaultScrollSeekPlaceholder\n  const TableBodyComponent = useEmitterValue('TableBodyComponent')!\n  const TableRowComponent = useEmitterValue('TableRowComponent')!\n  const computeItemKey = useEmitterValue('computeItemKey')\n  const isSeeking = useEmitterValue('isSeeking')\n  const paddingTopAddition = useEmitterValue('paddingTopAddition')\n  const scrolledToInitialItem = useEmitterValue('scrolledToInitialItem')\n  const firstItemIndex = useEmitterValue('firstItemIndex')\n\n  if (listState.items.length === 0 && EmptyPlaceholder && scrolledToInitialItem) {\n    return createElement(EmptyPlaceholder)\n  }\n\n  const paddingTop = listState.offsetTop + paddingTopAddition + deviation\n  const paddingBottom = listState.offsetBottom\n\n  const paddingTopEl = paddingTop > 0 ? <FillerRow height={paddingTop} key=\"padding-top\" /> : null\n\n  const paddingBottomEl = paddingBottom > 0 ? <FillerRow height={paddingBottom} key=\"padding-bottom\" /> : null\n\n  const items = listState.items.map((item) => {\n    const index = item.originalIndex!\n    const key = computeItemKey(index + firstItemIndex, item.data)\n\n    if (isSeeking) {\n      return createElement(ScrollSeekPlaceholder, {\n        key,\n        index: item.index,\n        height: item.size,\n        type: item.type || 'item',\n      })\n    }\n    return createElement(\n      TableRowComponent,\n      {\n        key,\n        'data-index': index,\n        'data-known-size': item.size,\n        'data-item-index': item.index,\n        style: { overflowAnchor: 'none' },\n      } as any,\n      itemContent(item.index, item.data)\n    )\n  })\n\n  return createElement(\n    TableBodyComponent,\n    { ref, 'data-test-id': 'virtuoso-item-list' },\n\n    [paddingTopEl, ...items, paddingBottomEl]\n  )\n})\n\nexport interface Hooks {\n  usePublisher: typeof usePublisher\n  useEmitterValue: typeof useEmitterValue\n  useEmitter: typeof useEmitter\n}\n\nconst Viewport: FC = ({ children }) => {\n  const viewportHeight = usePublisher('viewportHeight')\n  const viewportRef = useSize(compose(viewportHeight, (el) => correctItemSize(el, 'height')))\n\n  return (\n    <div style={viewportStyle} ref={viewportRef} data-viewport-type=\"element\">\n      {children}\n    </div>\n  )\n}\n\nconst WindowViewport: FC = ({ children }) => {\n  const windowViewportRect = usePublisher('windowViewportRect')\n  const scrollElement = useEmitterValue('scrollElement')\n  const viewportRef = useWindowViewportRectRef(windowViewportRect, scrollElement)\n\n  return (\n    <div ref={viewportRef} style={viewportStyle} data-viewport-type=\"window\">\n      {children}\n    </div>\n  )\n}\n\nconst TableRoot: FC<TableRootProps> = React.memo(function TableVirtuosoRoot(props) {\n  const useWindowScroll = useEmitterValue('useWindowScroll')\n  const scrollElement = useEmitterValue('scrollElement')\n  const fixedHeaderHeight = usePublisher('fixedHeaderHeight')\n  const fixedHeaderContent = useEmitterValue('fixedHeaderContent')\n  const theadRef = useSize(compose(fixedHeaderHeight, (el) => correctItemSize(el, 'height')))\n  const TheScroller = scrollElement || useWindowScroll ? WindowScroller : Scroller\n  const TheViewport = scrollElement || useWindowScroll ? WindowViewport : Viewport\n  const TheTable = useEmitterValue('TableComponent')\n  const TheTHead = useEmitterValue('TableHeadComponent')\n\n  const theHead = fixedHeaderContent\n    ? React.createElement(\n        TheTHead!,\n        { key: 'TableHead', style: { zIndex: 1, position: 'sticky', top: 0 }, ref: theadRef } as any,\n        fixedHeaderContent()\n      )\n    : null\n\n  return (\n    <TheScroller {...props}>\n      <TheViewport>\n        {React.createElement(TheTable!, { style: { borderSpacing: 0 } } as any, [theHead, <Items key=\"TableBody\" />])}\n      </TheViewport>\n    </TheScroller>\n  )\n})\n\nexport type TableHandle = RefHandle<typeof Table>\n\nexport const { Component: Table, usePublisher, useEmitterValue, useEmitter } = systemToComponent(\n  combinedSystem,\n  {\n    required: {},\n    optional: {\n      followOutput: 'followOutput',\n      firstItemIndex: 'firstItemIndex',\n      itemContent: 'itemContent',\n      fixedHeaderContent: 'fixedHeaderContent',\n      overscan: 'overscan',\n      increaseViewportBy: 'increaseViewportBy',\n      totalCount: 'totalCount',\n      topItemCount: 'topItemCount',\n      initialTopMostItemIndex: 'initialTopMostItemIndex',\n      components: 'components',\n      groupCounts: 'groupCounts',\n      atBottomThreshold: 'atBottomThreshold',\n      computeItemKey: 'computeItemKey',\n      defaultItemHeight: 'defaultItemHeight',\n      fixedItemHeight: 'fixedItemHeight',\n      itemSize: 'itemSize',\n      scrollSeekConfiguration: 'scrollSeekConfiguration',\n      data: 'data',\n      initialItemCount: 'initialItemCount',\n      initialScrollTop: 'initialScrollTop',\n      alignToBottom: 'alignToBottom',\n      useWindowScroll: 'useWindowScroll',\n      scrollElement: 'scrollElement',\n      scrollerRef: 'scrollerRef',\n      logLevel: 'logLevel',\n    },\n    methods: {\n      scrollToIndex: 'scrollToIndex',\n      scrollIntoView: 'scrollIntoView',\n      scrollTo: 'scrollTo',\n      scrollBy: 'scrollBy',\n    },\n    events: {\n      isScrolling: 'isScrolling',\n      endReached: 'endReached',\n      startReached: 'startReached',\n      rangeChanged: 'rangeChanged',\n      atBottomStateChange: 'atBottomStateChange',\n      atTopStateChange: 'atTopStateChange',\n      totalListHeightChanged: 'totalListHeightChanged',\n      itemsRendered: 'itemsRendered',\n      groupIndices: 'groupIndices',\n    },\n  },\n  TableRoot\n)\n\nconst Scroller = buildScroller({ usePublisher, useEmitterValue, useEmitter })\nconst WindowScroller = buildWindowScroller({ usePublisher, useEmitterValue, useEmitter })\n","import { ForwardRefExoticComponent, ReactElement, Ref } from 'react'\nimport { Grid, GridHandle } from './Grid'\n\nimport {\n  Components,\n  ComputeItemKey,\n  FollowOutput,\n  GridComponents,\n  GridComputeItemKey,\n  GridItemContent,\n  GroupContent,\n  GroupItemContent,\n  IndexLocationWithAlign,\n  ItemContent,\n  ListItem,\n  ListRange,\n  ScrollSeekConfiguration,\n  TableComponents,\n  FixedHeaderContent,\n} from './interfaces'\nimport { List, ListHandle } from './List'\nimport { Table } from './Table'\nimport { ScrollIntoViewLocation } from './scrollIntoViewSystem'\ntype CompProps<T> = T extends ForwardRefExoticComponent<infer R> ? R : never\ntype ListProps = CompProps<typeof List>\ntype GridProps = CompProps<typeof Grid>\n\nexport interface VirtuosoProps<D> extends Omit<ListProps, 'groupCounts' | 'groupContent' | 'itemsRendered'> {\n  /**\n   * The total amount of items to be rendered.\n   */\n  totalCount?: number\n\n  /**\n   * The data items to be rendered. If data is set, the total count will be inferred from the length of the array.\n   */\n  data?: readonly D[]\n\n  /**\n   * Set the overscan property to make the component \"chunk\" the rendering of new items on scroll.\n   * The property causes the component to render more items than the necessary, but reduces the re-renders on scroll.\n   * Setting `{ main: number, reverse: number }` lets you extend the list in both the main and the reverse scrollable directions.\n   * See the `increaseViewportBy` property for a similar behavior (equivalent to the `overscan` in `react-window`).\n   */\n  overscan?: number | { main: number; reverse: number }\n\n  /**\n   * Set the increaseViewportBy property to artificially increase the viewport size, causing items to be rendered before outside of the viewport.\n   * The property causes the component to render more items than the necessary, but can help with slow loading content.\n   * Using `{ top?: number, bottom?: number }` lets you set the increase for each end separately.\n   */\n  increaseViewportBy?: number | { top: number; bottom: number }\n\n  /**\n   * Set the amount of items to remain fixed at the top of the list.\n   *\n   * For a header that scrolls away when scrolling, check the `components.Header` property.\n   */\n  topItemCount?: number\n\n  /**\n   * Set to a value between 0 and totalCount - 1 to make the list start scrolled to that item.\n   */\n  initialTopMostItemIndex?: number\n\n  /**\n   * Set this value to offset the initial location of the list.\n   * Warning: using this property will still run a render cycle at the scrollTop: 0 list window.\n   * If possible, avoid using it and stick to `initialTopMostItemIndex` instead.\n   */\n  initialScrollTop?: number\n\n  /**\n   * Use for server-side rendering - if set, the list will render the specified amount of items\n   * regardless of the container / item size.\n   */\n  initialItemCount?: number\n\n  /**\n   * Use the `components` property for advanced customization of the elements rendered by the list.\n   */\n  components?: Components\n\n  /**\n   * Set the callback to specify the contents of the item.\n   */\n  itemContent?: ItemContent<D>\n\n  /**\n   * If specified, the component will use the function to generate the `key` property for each list item.\n   */\n  computeItemKey?: ComputeItemKey<D>\n\n  /**\n   * By default, the component assumes the default item height from the first rendered item (rendering it as a \"probe\").\n   *\n   * If the first item turns out to be an outlier (very short or tall), the rest of the rendering will be slower,\n   * as multiple passes of rendering should happen for the list to fill the viewport.\n   *\n   * Setting `defaultItemHeight` causes the component to skip the \"probe\" rendering and use the property\n   * value as default height instead.\n   */\n  defaultItemHeight?: number\n\n  /**\n   * Allows customizing the height/width calculation of `Item` elements.\n   *\n   * The default implementation reads `el.getBoundingClientRect().height` and `el.getBoundingClientRect().width`.\n   */\n  itemSize?: (el: HTMLElement, field: 'offsetHeight' | 'offsetWidth') => number\n\n  /**\n   * Can be used to improve performance if the rendered items are of known size.\n   * Setting it causes the component to skip item measurements.\n   */\n  fixedItemHeight?: number\n\n  /**\n   * Use to display placeholders if the user scrolls fast through the list.\n   *\n   * Set `components.ScrollSeekPlaceholder` to change the placeholder content.\n   */\n  scrollSeekConfiguration?: ScrollSeekConfiguration | false\n\n  /**\n   * If set to `true`, the list automatically scrolls to bottom if the total count is changed.\n   * Set to `\"smooth\"` for an animated scrolling.\n   *\n   * By default, `followOutput` scrolls down only if the list is already at the bottom.\n   * To implement an arbitrary logic behind that, pass a function:\n   *\n   * ```tsx\n   * <Virtuoso\n   *  followOutput={(isAtBottom: boolean) => {\n   *    if (expression) {\n   *      return 'smooth' // can be 'auto' or false to avoid scrolling\n   *    } else {\n   *      return false\n   *    }\n   *  }} />\n   * ```\n   */\n  followOutput?: FollowOutput\n\n  /**\n   * Set to customize the wrapper tag for the header and footer components (default is `div`).\n   */\n  headerFooterTag?: string\n\n  /**\n   * Use when implementing inverse infinite scrolling - decrease the value this property\n   * in combination with  `data` or `totalCount` to prepend items to the top of the list.\n   *\n   * Warning: the firstItemIndex should **be a positive number**, based on the total amount of items to be displayed.\n   */\n  firstItemIndex?: number\n\n  /**\n   * Called when the list starts/stops scrolling.\n   */\n  isScrolling?: (isScrolling: boolean) => void\n\n  /**\n   * Gets called when the user scrolls to the end of the list.\n   * Receives the last item index as an argument. Can be used to implement endless scrolling.\n   */\n  endReached?: (index: number) => void\n\n  /**\n   * Called when the user scrolls to the start of the list.\n   */\n  startReached?: (index: number) => void\n\n  /**\n   * Called with the new set of items each time the list items are rendered due to scrolling.\n   */\n  rangeChanged?: (range: ListRange) => void\n\n  /**\n   * Called with true / false when the list has reached the bottom / gets scrolled up.\n   * Can be used to load newer items, like `tail -f`.\n   */\n  atBottomStateChange?: (atBottom: boolean) => void\n\n  /**\n   * Called with `true` / `false` when the list has reached the top / gets scrolled down.\n   */\n  atTopStateChange?: (atTop: boolean) => void\n\n  /**\n   * Called when the total list height is changed due to new items or viewport resize.\n   */\n  totalListHeightChanged?: (height: number) => void\n\n  /**\n   * Called with the new set of items each time the list items are rendered due to scrolling.\n   */\n  itemsRendered?: (items: ListItem<D>[]) => void\n\n  /**\n   * Setting `alignToBottom` to `true` aligns the items to the bottom of the list if the list is shorter than the viewport.\n   * Use `followOutput` property to keep the list aligned when new items are appended.\n   */\n  alignToBottom?: boolean\n\n  /**\n   * Uses the document scroller rather than wrapping the list in its own.\n   */\n  useWindowScroll?: boolean\n\n  /**\n   * Uses an external scroll element rather than wrapping the list in its own.\n   */\n  scrollElement?: HTMLElement\n\n  /**\n   * Provides access to the root DOM element\n   */\n  scrollerRef?: (ref: HTMLElement | Window | null) => any\n\n  /**\n   * By default `4`. Redefine to change how much away from the bottom the scroller can be before the list is not considered not at bottom.\n   */\n  atBottomThreshold?: number\n}\n\nexport interface GroupedVirtuosoProps<D>\n  extends Omit<VirtuosoProps<D>, 'totalCount' | 'itemContent'>,\n    Pick<ListProps, 'groupCounts' | 'groupContent'> {\n  /**\n   * Specifies the amount of items in each group (and, actually, how many groups are there).\n   * For example, passing [20, 30] will display 2 groups with 20 and 30 items each.\n   */\n  groupCounts?: number[]\n\n  /**\n   * Specifies how each each group header gets rendered. The callback receives the zero-based index of the group.\n   */\n  groupContent?: GroupContent\n\n  /**\n   * Specifies how each each item gets rendered.\n   */\n  itemContent?: GroupItemContent<D>\n}\n\nexport interface TableVirtuosoProps<D> extends Omit<VirtuosoProps<D>, 'components' | 'headerFooterTag' | 'topItemCount'> {\n  /**\n   * Use the `components` property for advanced customization of the elements rendered by the table.\n   */\n  components?: TableComponents\n  /**\n   * Set the contents of the table header.\n   */\n  fixedHeaderContent?: FixedHeaderContent\n\n  /**\n   * The total amount of items to be rendered.\n   */\n  totalCount?: number\n\n  /**\n   * The data items to be rendered. If data is set, the total count will be inferred from the length of the array.\n   */\n  data?: readonly D[]\n\n  /**\n   * Set the overscan property to make the component \"chunk\" the rendering of new items on scroll.\n   * The property causes the component to render more items than the necessary, but reduces the re-renders on scroll.\n   * Setting `{ main: number, reverse: number }` lets you extend the list in both the main and the reverse scrollable directions.\n   * See the `increaseViewportBy` property for a similar behavior (equivalent to the `overscan` in `react-window`).\n   */\n  overscan?: number | { main: number; reverse: number }\n\n  /**\n   * Set the increaseViewportBy property to artificially increase the viewport size, causing items to be rendered before outside of the viewport.\n   * The property causes the component to render more items than the necessary, but can help with slow loading content.\n   * Using `{ top?: number, bottom?: number }` lets you set the increase for each end separately.\n   */\n  increaseViewportBy?: number | { top: number; bottom: number }\n\n  /**\n   * Set to a value between 0 and totalCount - 1 to make the list start scrolled to that item.\n   */\n  initialTopMostItemIndex?: number\n\n  /**\n   * Set this value to offset the initial location of the list.\n   * Warning: using this property will still run a render cycle at the scrollTop: 0 list window.\n   * If possible, avoid using it and stick to `initialTopMostItemIndex` instead.\n   */\n  initialScrollTop?: number\n\n  /**\n   * Use for server-side rendering - if set, the list will render the specified amount of items\n   * regardless of the container / item size.\n   */\n  initialItemCount?: number\n\n  /**\n   * Set the callback to specify the contents of the item.\n   */\n  itemContent?: ItemContent<D>\n\n  /**\n   * If specified, the component will use the function to generate the `key` property for each list item.\n   */\n  computeItemKey?: ComputeItemKey<D>\n\n  /**\n   * By default, the component assumes the default item height from the first rendered item (rendering it as a \"probe\").\n   *\n   * If the first item turns out to be an outlier (very short or tall), the rest of the rendering will be slower,\n   * as multiple passes of rendering should happen for the list to fill the viewport.\n   *\n   * Setting `defaultItemHeight` causes the component to skip the \"probe\" rendering and use the property\n   * value as default height instead.\n   */\n  defaultItemHeight?: number\n\n  /**\n   * Allows customizing the height/width calculation of `Item` elements.\n   *\n   * The default implementation reads `el.getBoundingClientRect().height` and `el.getBoundingClientRect().width`.\n   */\n  itemSize?: (el: HTMLElement, field: 'offsetHeight' | 'offsetWidth') => number\n\n  /**\n   * Can be used to improve performance if the rendered items are of known size.\n   * Setting it causes the component to skip item measurements.\n   */\n  fixedItemHeight?: number\n\n  /**\n   * Use to display placeholders if the user scrolls fast through the list.\n   *\n   * Set `components.ScrollSeekPlaceholder` to change the placeholder content.\n   */\n  scrollSeekConfiguration?: ScrollSeekConfiguration | false\n\n  /**\n   * If set to `true`, the list automatically scrolls to bottom if the total count is changed.\n   * Set to `\"smooth\"` for an animated scrolling.\n   *\n   * By default, `followOutput` scrolls down only if the list is already at the bottom.\n   * To implement an arbitrary logic behind that, pass a function:\n   *\n   * ```tsx\n   * <Virtuoso\n   *  followOutput={(isAtBottom: boolean) => {\n   *    if (expression) {\n   *      return 'smooth' // can be 'auto' or false to avoid scrolling\n   *    } else {\n   *      return false\n   *    }\n   *  }} />\n   * ```\n   */\n  followOutput?: FollowOutput\n\n  /**\n   * Use when implementing inverse infinite scrolling - decrease the value this property\n   * in combination with  `data` or `totalCount` to prepend items to the top of the list.\n   *\n   * Warning: the firstItemIndex should **be a positive number**, based on the total amount of items to be displayed.\n   */\n  firstItemIndex?: number\n\n  /**\n   * Called when the list starts/stops scrolling.\n   */\n  isScrolling?: (isScrolling: boolean) => void\n\n  /**\n   * Gets called when the user scrolls to the end of the list.\n   * Receives the last item index as an argument. Can be used to implement endless scrolling.\n   */\n  endReached?: (index: number) => void\n\n  /**\n   * Called when the user scrolls to the start of the list.\n   */\n  startReached?: (index: number) => void\n\n  /**\n   * Called with the new set of items each time the list items are rendered due to scrolling.\n   */\n  rangeChanged?: (range: ListRange) => void\n\n  /**\n   * Called with true / false when the list has reached the bottom / gets scrolled up.\n   * Can be used to load newer items, like `tail -f`.\n   */\n  atBottomStateChange?: (atBottom: boolean) => void\n\n  /**\n   * Called with `true` / `false` when the list has reached the top / gets scrolled down.\n   */\n  atTopStateChange?: (atTop: boolean) => void\n\n  /**\n   * Called when the total list height is changed due to new items or viewport resize.\n   */\n  totalListHeightChanged?: (height: number) => void\n\n  /**\n   * Called with the new set of items each time the list items are rendered due to scrolling.\n   */\n  itemsRendered?: (items: ListItem<D>[]) => void\n\n  /**\n   * Setting `alignToBottom` to `true` aligns the items to the bottom of the list if the list is shorter than the viewport.\n   * Use `followOutput` property to keep the list aligned when new items are appended.\n   */\n  alignToBottom?: boolean\n\n  /**\n   * Uses the document scroller rather than wrapping the list in its own.\n   */\n  useWindowScroll?: boolean\n\n  /**\n   * Uses an external scroll element rather than wrapping the list in its own.\n   */\n  scrollElement?: HTMLElement\n\n  /**\n   * Provides access to the root DOM element\n   */\n  scrollerRef?: (ref: HTMLElement | Window | null) => any\n\n  /**\n   * By default `4`. Redefine to change how much away from the bottom the scroller can be before the list is not considered not at bottom.\n   */\n  atBottomThreshold?: number\n}\n\nexport interface VirtuosoGridProps extends GridProps {\n  /**\n   * The total amount of items to be rendered.\n   */\n  totalCount: number\n\n  /**\n   * Set the callback to specify the contents of the item.\n   */\n  itemContent?: GridItemContent\n\n  /**\n   * Use the `components` property for advanced customization of the elements rendered by the list.\n   */\n  components?: GridComponents\n\n  /**\n   * Set the overscan property to make the component \"chunk\" the rendering of new items on scroll.\n   * The property causes the component to render more items than the necessary, but reduces the re-renders on scroll.\n   * Setting `{ main: number, reverse: number }` lets you extend the list in both the main and the reverse scrollable directions.\n   */\n  overscan?: number | { main: number; reverse: number }\n\n  /**\n   * If specified, the component will use the function to generate the `key` property for each list item.\n   */\n  computeItemKey?: GridComputeItemKey\n\n  /**\n   * Use to display placeholders if the user scrolls fast through the list.\n   *\n   * Set `components.ScrollSeekPlaceholder` to change the placeholder content.\n   */\n  scrollSeekConfiguration?: ScrollSeekConfiguration | false\n\n  /**\n   * Called when the list starts/stops scrolling.\n   */\n  isScrolling?: (isScrolling: boolean) => void\n\n  /**\n   * Gets called when the user scrolls to the end of the list.\n   * Receives the last item index as an argument. Can be used to implement endless scrolling.\n   */\n  endReached?: (index: number) => void\n\n  /**\n   * Called when the user scrolls to the start of the list.\n   */\n  startReached?: (index: number) => void\n\n  /**\n   * Called with the new set of items each time the list items are rendered due to scrolling.\n   */\n  rangeChanged?: (range: ListRange) => void\n\n  /**\n   * Called with true / false when the list has reached the bottom / gets scrolled up.\n   * Can be used to load newer items, like `tail -f`.\n   */\n  atBottomStateChange?: (atBottom: boolean) => void\n\n  /**\n   * Called with `true` / `false` when the list has reached the top / gets scrolled down.\n   */\n  atTopStateChange?: (atTop: boolean) => void\n\n  /**\n   * Provides access to the root DOM element\n   */\n  scrollerRef?: (ref: HTMLElement | null) => any\n\n  /**\n   * Sets the className for the list DOM element\n   */\n  listClassName?: string\n\n  /**\n   * Sets the grid items' className\n   */\n  itemClassName?: string\n\n  /**\n   * Uses the document scroller rather than wrapping the grid in its own.\n   */\n  useWindowScroll?: boolean\n\n  /**\n   * Uses an external scroll element rather than wrapping the grid in its own.\n   */\n  scrollElement?: HTMLElement\n}\n\nexport interface VirtuosoHandle extends ListHandle {\n  /**\n   * Scrolls the component to the specified item index. See {{IndexLocationWithAlign}} for more options.\n   */\n  scrollToIndex(location: number | IndexLocationWithAlign): void\n  /**\n   * Scrolls the item into view if necessary. See [the website example](http://virtuoso.dev/keyboard-navigation/) for an implementation.\n   */\n  scrollIntoView(location: ScrollIntoViewLocation): void\n  /**\n   * Scrolls the component to the specified location. See [ScrollToOptions (MDN)](https://developer.mozilla.org/en-US/docs/Web/API/ScrollToOptions)\n   */\n  scrollTo(location: ScrollToOptions): void\n  /**\n   * Scrolls the component with the specified amount. See [ScrollToOptions (MDN)](https://developer.mozilla.org/en-US/docs/Web/API/ScrollToOptions)\n   */\n  scrollBy(location: ScrollToOptions): void\n}\n\nexport interface GroupedVirtuosoHandle extends ListHandle {\n  scrollToIndex(location: number | IndexLocationWithAlign): void\n  scrollTo(location: ScrollToOptions): void\n  scrollBy(location: ScrollToOptions): void\n}\n\nexport interface VirtuosoGridHandle extends GridHandle {\n  scrollToIndex(location: number | IndexLocationWithAlign): void\n  scrollTo(location: ScrollToOptions): void\n  scrollBy(location: ScrollToOptions): void\n}\n\nexport const Virtuoso = List as <D extends unknown = any>(props: VirtuosoProps<D> & { ref?: Ref<VirtuosoHandle> }) => ReactElement\nexport const GroupedVirtuoso = List as <D extends unknown = any>(\n  props: GroupedVirtuosoProps<D> & { ref?: Ref<GroupedVirtuosoHandle> }\n) => ReactElement\nexport const TableVirtuoso = Table as any\nexport const VirtuosoGrid = Grid as any\n","import ExploreGridItem from './ExploreGridItem';\nimport { VirtuosoGrid } from '../../../react-virtuoso/src';\n//import {VirtuosoGrid} from 'react-virtuoso'\nimport styled from '@emotion/styled';\n\nconst ItemContainer = styled.div`\n  padding: 0.5rem;\n  width: 25%;\n  display: flex;\n  flex: none;\n  align-content: stretch;\n\n  @media (max-width: 1300px) {\n    width: 33%;\n  }\n\n  @media (max-width: 1200px) {\n    width: 50%;\n  }\n\n  @media (max-width: 550px) {\n    width: 100%;\n  }\n`;\n\nconst ListContainer = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n`;\n\nexport default function ExploreGrid({ data, height, GridItem = ExploreGridItem, scrollElement = undefined }) {  \n  return (\n    <VirtuosoGrid\n      scrollElement={scrollElement}\n      totalCount={data.length}\n      style={{ height: scrollElement ? undefined : height }}\n      components={{\n        Item: ItemContainer,\n        List: ListContainer as any,\n        ScrollSeekPlaceholder: ({ height, width, index }) => (\n          <ItemContainer>\n            <ExploreGridItem>--</ExploreGridItem>\n          </ItemContainer>\n        )\n      }}\n      itemContent={index => {\n        const item = data[index] ?? {};\n        const values = item.getValues ? item.getValues() : item;        \n        return values && <GridItem index={index} {...values} />;\n      }}\n      /*scrollSeekConfiguration={{\n        enter: velocity => Math.abs(velocity) > 1200,\n        exit: velocity => Math.abs(velocity) < 30\n        // change: (_, range) => console.log({ range })\n      }}\n      */\n    />\n  );\n}\n","import * as React from 'react';\nimport { useTheme } from '@material-ui/core';\nimport AutoSizer from 'react-virtualized/dist/commonjs/AutoSizer';\nimport Component from '@reactions/component';\nimport { evalFunc } from '../../../helpers';\nimport { CellMeasurer, CellMeasurerCache, List } from 'react-virtualized';\n\nexport interface VirtualListProps {\n  name?: string;\n  height?: number;\n  columns?: any[] | ((props?) => any[]);\n  data?: any[];\n  rowHeight?: number;\n}\n\nexport default function VirtualList(props: VirtualListProps) {\n  const { layout } = useTheme() as any;\n  const { rowHeight = layout.tableRowHeight, data, columns, height } = props;\n\n  const sortinjectedcolumns = evalFunc(columns, props);\n\n  return (\n    <div style={{ height: height }}>\n      <Component initialState={{ selectedRowIds: [] }}>\n        {({ state }) => {\n          const selectedRowIds = state.selectedRowIds;\n          const length = selectedRowIds.length;\n          const adjustedheight = length > 0 ? height - layout.multiselectbarheight - layout.contentrowspacing : height;\n          return (\n            <AutoSizer>\n              {({ width }) => <DynamicList data={data} rowHeight={rowHeight} width={width as any} height={adjustedheight} columns={sortinjectedcolumns} />}\n            </AutoSizer>\n          );\n        }}\n      </Component>\n    </div>\n  );\n}\n\nconst DynamicList = props => {\n  const { height, width, data, columns, rowHeight = 50, getClassName } = props as any;\n\n  const handleRefresh = () => {\n    setCache(\n      new CellMeasurerCache({\n        fixedWidth: true,\n        minHeight: rowHeight\n      })\n    );\n  };\n\n  React.useEffect(() => {\n    setCache(\n      new CellMeasurerCache({\n        fixedWidth: true,\n        minHeight: rowHeight\n      })\n    );\n  }, [data, columns, getClassName, height, rowHeight, width]);\n\n  const [cache, setCache] = React.useState(\n    new CellMeasurerCache({\n      fixedWidth: true,\n      minHeight: props.rowHeight ?? 50\n    })\n  );\n\n  const _rowRenderer = ({ index, key, parent, style }) => {\n    const classNames = getClassName && getClassName({ columnIndex: 0, rowIndex: index });\n    return (\n      <CellMeasurer cache={cache} columnIndex={0} key={key} rowIndex={index} parent={parent}>\n        {({ measure, registerChild }) => (\n          <div ref={registerChild} className={classNames} style={style}>\n            {columns[0].cell({ ...data[index], handleRefresh }, columns[0])}\n          </div>\n        )}\n      </CellMeasurer>\n    );\n  };\n\n  return (\n    <List\n      deferredMeasurementCache={cache}\n      height={height}\n      overscanRowCount={0}\n      rowCount={data.length}\n      rowHeight={cache.rowHeight}\n      rowRenderer={_rowRenderer}\n      width={width}\n    />\n  );\n};\n","import * as React from 'react';\nimport { useSelector } from 'react-redux';\nimport { AppState } from '../../../store';\nimport TablePlaceHolder from './TablePlaceHolder';\nimport VirtualTable, { VirtualTableProps } from './VirtualTable';\nimport { Typography, Divider, useTheme, makeStyles, createStyles, Paper, Grid } from '@material-ui/core';\nimport ExploreGrid from './ExploreGrid';\nimport VirtualList from './VirtualList';\n\nexport interface GenericTableProps extends VirtualTableProps {\n  footer?: boolean;\n  elevation?: number;\n  placeholder?: string | React.ReactNode;\n  selector?(state, props): [];\n  length?: number;\n  isGrid?: boolean;\n  isList?: boolean;\n}\n\nconst useStyles = makeStyles(({ palette, spacing, layout }: any) =>\n  createStyles({\n    placeholder: {\n      padding: spacing(1),\n      background: palette.grey[50]\n    },\n    footer: {\n      paddingRight: spacing(1),\n      background: palette.grey[200],\n      border: 8,\n      height: layout.tablefooterheight,\n      color: palette.text.hint\n    },\n    paper: ({ rounded }: any) => ({\n      borderBottomLeftRadius: rounded ? 4 : 0,\n      borderBottomRightRadius: rounded ? 4 : 0\n    })\n  })\n);\n\nexport default function GenericTable(props: GenericTableProps) {\n  const { elevation = 4, placeholder, footer, name, selector, data: Data = [], height: Height, isList, isGrid, ...other } = props;\n  const classes = useStyles(props);\n  const { layout } = useTheme() as any;\n  const data = useSelector((state: AppState) => (selector ? selector(state, props) : Data));\n  const length = data && data.length ? data.length : 0;\n  const height = footer ? (Height ? Height - layout.tablefooterheight : Height) : Height;\n\n  const VirtualComponent = isList ? VirtualList : isGrid ? ExploreGrid : VirtualTable;\n\n  return (\n    <Paper elevation={elevation} className={classes.paper}>\n      {length === 0 ? (\n        <Grid style={{ height: height }} container className={classes.placeholder} alignItems='center' justify='center'>\n          <Grid item xs>\n            <TablePlaceHolder {...props} />\n          </Grid>\n          <Grid item xs={12} />\n        </Grid>\n      ) : (\n        <VirtualComponent name={name} data={data} height={height} {...other} />\n      )}\n      {footer && (\n        <>\n          <Divider />\n          <Grid container className={classes.footer} alignContent='center' alignItems='center' justify='flex-end'>\n            <Grid item container alignItems='center' justify='flex-end'>\n              <Typography align='right' variant='caption'>\n                Viewing {length} {name}\n              </Typography>\n            </Grid>\n          </Grid>\n        </>\n      )}\n    </Paper>\n  );\n}\n"],"sourceRoot":""}